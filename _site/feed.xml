<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.0">Jekyll</generator><link href="https://balit.ski/feed.xml" rel="self" type="application/atom+xml" /><link href="https://balit.ski/" rel="alternate" type="text/html" /><updated>2021-01-19T21:55:49-05:00</updated><id>https://balit.ski/feed.xml</id><title type="html">От комбинаторики к геометрии</title><subtitle>Записки физтеховского курса по комбинаторике с геометрическими приложениями</subtitle><entry><title type="html">Теорема Какутани</title><link href="https://balit.ski/lecture/2018/05/27/lecture11.html" rel="alternate" type="text/html" title="Теорема Какутани" /><published>2018-05-27T00:00:00-04:00</published><updated>2018-05-27T00:00:00-04:00</updated><id>https://balit.ski/lecture/2018/05/27/lecture11</id><content type="html" xml:base="https://balit.ski/lecture/2018/05/27/lecture11.html">&lt;script src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js&quot;&gt;&lt;/script&gt;

&lt;script src=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.js&quot;&gt;&lt;/script&gt;

&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.css&quot; /&gt;

&lt;script&gt;
  disqus_shortname = 'balit-ski';
  jQuery(document).ready(function() {
    jQuery(&quot;p&quot;).inlineDisqussions();
  });
&lt;/script&gt;

&lt;h2 id=&quot;210&quot;&gt;—2.10—&lt;/h2&gt;

&lt;p&gt;Теорема Брауэра – первый важный результат в серии топологических теорем о неподвижной точке. Мы выведем из неё другую более общую теорему о неподвижной точке. Для этого введём &lt;em&gt;множественнозначные&lt;/em&gt; отображения. Пусть \(\Phi: S \to 2^S\) – отображение, которое ставит каждой точке \(x \in S \subset \mathbb{R}^r\) в соответствие  подмножество \(\Phi(x) \subset S\). В случае, когда все образы \(\Phi(x)\) состоят из одного элемента, отображение \(\Phi\) определяет обычное отображение \(S \to S\). В этом смысле множественнозначные отображения обобщают обычные. Множественнозначное отображение \(\Phi\) называется &lt;em&gt;замкнутым&lt;/em&gt;, если “предельная точка образов принадлежит образу предельной точки”; формально, для любых сходящихся в \(S\) последовательностей \(x_i \to x\), \(y_i \to y\), таких что \(y_i \in \Phi(x_i)\), выполнено \(y \in \Phi(x)\). Это понятие обобщает понятие непрерывности обычных отображений. Точка \(x \in S\) называется &lt;em&gt;неподвижной&lt;/em&gt;, если \(x \in \Phi(x)\).&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Kakutani, 1941].&lt;/strong&gt; Пусть \(\Phi : S \to 2^S\) множественнозначное отображение выпуклого компакта \(S \subset \mathbb{R}^r\), такое что образы точек непустые и выпуклые, а отображение замкнуто. Тогда существует неподвижная точка \(x \in S, x \in \Phi(x)\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Ясно, что эта теорема прямо обобщает теорему Брауэра. Идея доказательства ниже состоит в том, что мы будем приближать \(\Phi\) обычными непрерывными отображениями, применять для них теорему Брауэра, а затем осуществим предельный переход.&lt;/p&gt;

&lt;p&gt;Без потери общности можно доказывать теорему для случая, когда \(S\) – \(r\)-мерный вероятностный симплекс в \(\mathbb{r+1}\). Поясню, почему. Если \(S\) – произвольный выпуклый компакт, то мы можем вложить его в большой симплекс \(S’\), и рассмотреть отображение ортогонального проектирования \(p : S’ \to S\). Затем мы доопределяем \(\Phi\) на \(S’\) по формуле \(\Phi(x) := \Phi(p(x))\), замкнутость и выпуклость образов сохраняется, и неподвижная точка такого отображения будет лежать в \(S\).&lt;/p&gt;

&lt;p&gt;Итак, пусть теперь \(S = \{(x_0, \ldots, x_r) \in \mathbb{R}^{r+1}: x_i \ge 0, \sum x_i = 1\}\). Раздробим \(S\) на мелкие симплексы. Мы сейчас построим кусочно-линейное отображение \(\varphi_1 : S \to S\), которое, грубо говоря, приближает отображение \(\Phi\) на нашем масштабе измельчения. Для каждой вершины \(v\) разбиения определим \(\varphi_1(v)\) как произвольный элемент из \(\Phi(v)\). Затем доопределим \(\varphi_1\) по линейности. Мы получим непрерывное отображение \(S\) в себя, по теореме Брауэра у него есть неподвижная точка \(x_1\). Если она лежит в малом симплексе разбиения в вершинами \(x_{1,0}, \ldots, x_{1,r}\), то мы можем записать \(x_1\) в виде выпуклой комбинации \(x_1 = \lambda_{1,0} x_{1,0} + \ldots + \lambda_{1,r} x_{1,r}\).&lt;/p&gt;

&lt;p&gt;Раздробим \(S\) ещё мельче, и аналогично найдём неподвижную точку \(x_2 = \lambda_{2,0} x_{2,0} + \ldots + \lambda_{2,r} x_{2,r}\) кусочно-линейной аппроксимации \(\varphi_2\). Продолжим измельчать, аппроксимировать \(\Phi\) и применять теорему Брауэра, так что получим последовательность неподвижных точек отображений-аппроксимаций \(x_i = \lambda_{i,0} x_{i,0} + \ldots + \lambda_{i,r} x_{i,r}\). Из соображений компактности можно проредить последовательность, так что \(x_i \to x\). Так как подразбиение на симплексы всё более мелкое, то \(x_{i,0} \to x, \ldots x_{i,r} \to x\). Прореживая дополнительно, мы можем полагать, что \(\lambda_{i,0} \to \lambda_0\), \(\ldots\), \(\lambda_{i,r} \to \lambda_r\), \(\varphi_i(x_{i,0}) \to y_0\), \(\ldots\), \(\varphi_i(x_{i,r}) \to y_r\). Из замкнутости \(\Phi\) следует, что \(y_0, \ldots, y_r \in \Phi(x)\). Из выпуклости \(\Phi(x)\) тогда заключаем, что \(x = \lambda_0 y_0 + \ldots + \lambda_r y_r \in \Phi(x)\).
\(\square\)&lt;/p&gt;

&lt;h2 id=&quot;211&quot;&gt;—2.11—&lt;/h2&gt;

&lt;p&gt;В качестве приложения выведем уже знакомую нам теорему фон Неймана о минимаксе.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [von Neumann revisited].&lt;/strong&gt; Пусть функция \(h(x,y)\) двух векторных аргументов определена на произведении \(K \times L\) выпуклых компактов. Пусть \(h\) квазивогнута по \(x\), квазивыпукла по \(y\), и непрерывна по совокупности аргументов. Тогда 
\[
\max_{x} \min_{y} h(x,y) = \min_{y} \max_{x} h(x,y).
\]&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Вывод из теоремы Какутани.&lt;/em&gt; 
Для каждого \(x \in K\) положим
\[
L_x = \{y \in L ~|~ h(x,y) = \min_{\eta \in L} h(x,\eta)\}.
\]
Аналогично, для каждого \(y \in L\) положим
\[
K_y = \{x \in K ~|~ h(x,y) = \min_{\xi \in K} h(\xi,y)\}.
\]
Определим множественнозначное отображение \(\Phi: K\times L \to 2^{K\times L}\) так:
\[
\Phi(x,y) = K_y \times L_x.
\]
Легко проверить, что отображение \(\Phi\) удовлетворяет условиям теоремы Какутани, и, значит, имеет неподвижную точку. Эта точка является седловой точкой функции \(h\). 
\(\square\)&lt;/p&gt;

&lt;h2 id=&quot;212&quot;&gt;—2.12—&lt;/h2&gt;

&lt;p&gt;Теорема Какутани наиболее известна своими приложениями в матэкономике. Самое популярное из них – существование равновесий Нэша; за этот результат Джон Нэш получил нобелевскую премию по экономике.&lt;/p&gt;

&lt;p&gt;Постановка задачи такая. Рассматривается &lt;em&gt;конечная игра&lt;/em&gt; двух игроков. Два игрока независимо друг от друга поставлены в некую ситуацию, и каждый из них имеет несколько вариантов поведения. После того, как игроки определились со стратегиями поведения (не зная, как поведёт себя соперник), вычисляются выигрыши обоих игроков. Пусть \(S^{(k)}\) – конечное множество (чистых) стратегий игрока \(k\), \(k = 1,2,\), а \(u^{(k)} : S^{(1)} \times S^{(2)} \to \mathbb{R}\) – функция выигрыша (функция полезности) игрока \(k\). Пара стратегий \((\bar s^{(1)},\bar s^{(2)})\) называется &lt;em&gt;равновесием Нэша в чистых стратегиях&lt;/em&gt;, если ни одному из игроков не выгодно менять стратегию \(\bar s^{(k)}\) на другую. Формально, должны выполняться неравенства
\[
u^{(1)}(\bar s^{(1)}, \bar s^{(2)}) \ge u^{(1)}(s^{(1)}, \bar s^{(2)}) \quad \forall s^{(1)} \in S^{(1)};
\]
\[
u^{(2)}(\bar s^{(1)}, \bar s^{(2)}) \ge u^{(2)}(\bar s^{(1)}, s^{(2)}) \quad \forall s^{(2)} \in S^{(2)}.
\]
Недостаток равновесия в чистых стратегиях – его может не существовать (придумайте пример!). Однако мы можем ввести элемент недетерминированности в нашу постановку: пусть игроки выбирают стратегии вероятностным образом. &lt;em&gt;Смешанная стратегия&lt;/em&gt; игрока \(k\) определяется как вероятностное распределение \(\mu^{(k)}\) на множестве \(S^{(k)}\), т.е. набор неотрицательных чисел \(\mu_i^{(k)}, i \in S^{(k)}\), с суммой, равной 1. Выигрыш игрока \(k\) для пары смешанных стратегий \((\mu^{(1)}, \mu^{(2)})\) вычисляется как
\[
U^{(k)}(\mu^{(1)}, \mu^{(2)}) = \sum_{i \in S^{(1)}} \sum_{j \in S^{(2)}} \mu_i^{(1)} \mu_j^{(2)} u^{(k)}(i,j).
\]
Смешанная стратегия \(\mu^{(2)}\) игрока 2 называется &lt;em&gt;лучшим ответом&lt;/em&gt; на смешанную стратегию \(\mu^{(1)}\) игрока 1, если для любой другой смешанной стратегии \(\nu^{(2)}\) игрока 2 выполняется неравенство
\[
U^{(2)}(\mu^{(1)}, \mu^{(2)}) \ge U^{(2)}(\mu^{(1)}, \nu^{(2)}).
\]
Аналогично определяется лучший ответ игрока 1 игроку 2. Пара смешанных стратегий \((\mu^{(1)},\mu^{(2)})\) называется &lt;em&gt;равновесием Нэша в смешанных стратегиях&lt;/em&gt;, если обе стратегии в ней являются лучшими ответами друг на друга.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Nash, 1950].&lt;/strong&gt; Равновесие Нэша в смешанных стратегиях существует.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Множество смешанных стратегий каждого игрока – вероятностный симплекс. На произведении этих симплексов определим множественнозначное отображение \(\Phi\) следующим образом: положим пару смешанных стратегий \((\nu^{(1)}, \nu^{(2)})\) в множество \(\Phi(\mu^{(1)}, \mu^{(2)})\), если \(\nu^{(1)}\) является лучшим ответом на \(\mu^{(2)}\), а \(\nu^{(2)}\) является лучшим ответом на \(\mu^{(1)}\). Прямая проверка показывает, что \(\Phi\) замкнуто, и имеет образами точек непустые выпуклые множества. Неподвижная точка \(\Phi\) и есть равновесие Нэша.
\(\square\)&lt;/p&gt;</content><author><name></name></author><category term="lecture" /><summary type="html"></summary></entry><entry><title type="html">Третий взгляд: степень отображения</title><link href="https://balit.ski/lecture/2018/05/19/lecture10.html" rel="alternate" type="text/html" title="Третий взгляд: степень отображения" /><published>2018-05-19T00:00:00-04:00</published><updated>2018-05-19T00:00:00-04:00</updated><id>https://balit.ski/lecture/2018/05/19/lecture10</id><content type="html" xml:base="https://balit.ski/lecture/2018/05/19/lecture10.html">&lt;script src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js&quot;&gt;&lt;/script&gt;

&lt;script src=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.js&quot;&gt;&lt;/script&gt;

&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.css&quot; /&gt;

&lt;script&gt;
  disqus_shortname = 'balit-ski';
  jQuery(document).ready(function() {
    jQuery(&quot;p&quot;).inlineDisqussions();
  });
&lt;/script&gt;

&lt;h2 id=&quot;27&quot;&gt;—2.7—&lt;/h2&gt;

&lt;p&gt;В этой лекции я соберу несколько простых топологических следствий леммы Шпернера. Все эти утверждения объединены идеей степени отображения, дискретным суррогатом которой и является лемма Шпернера. Наш первый этюд – теорема о причёсывании ежа.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Brouwer, 1912].&lt;/strong&gt; Не существует непрерывного ненулевого касательного поля к сфере \(S^2\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Что значат эти слова? Мы считаем, что сфера \(S^2 = \{ (x,y,z) \in \mathbb{R}^3 : x^2 + y^2 + z^2 \le 1 \}\) вложена в \(\mathbb{R}^3\) естественным образом. &lt;em&gt;Касательным полем&lt;/em&gt; к сфере называется непрерывная вектор-функция \(v(\cdot)\), назначающая каждой точке \(x \in S^2\) касательный сфере вектор \(v(x)\). Теорема утверждает, что хотя бы один касательный вектор обязан обнулиться. Из популярных интерпретаций: на земном шаре не может повсюду быть ветер; морского ежа нельзя гладко причесать без проборов и завихрений.&lt;/p&gt;

&lt;p&gt;Доказательство будет основано на следующей версии леммы Шпернера.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма.&lt;/strong&gt; Пусть многоугольник триангулирован, и каждая вершина триангуляции раскрашена в один из трёх цветов A, B, C. Обозначим через \(d_{AB}\) количество рёбер, покрашенных как AB, если мы обходим границу многоугольника по часовой стрелке; через \(d_{BA}\) – количество рёбер, покрашенных как BA при обходе по часовой стрелке. Тогда найдётся хотя бы \(|d_{AB} - d_{BA}|\) разноцветных треугольников.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt;
Пусть, например, \(d_{AB} &amp;gt; d_{BA}\).
Повторим доказательство с дверьми в замке (—2.1—). На этот раз ориентируем все двери AB так, что пройти в двери можно только в одном направлении (скажем, при проходе через дверь цвет A должен быть слева). Тогда в нашем замке \(d_{AB}\) внешних входов и \(d_{BA}\) выходов. Поэтому если мы будем гулять по замку, мы найдём как минимум \(d_{AB} - d_{BA}\) тупиковых (т.е. разноцветных) комнат.
\(\square\)&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Доказательство теоремы о причёсывании ежа.&lt;/em&gt; 
Предположим, ненулевое касательное поле \(v\) нашлось. Мы нарисуем на сфере ещё одно семейство ориентированных линий, которое будем называть координатными. Эти линии устроены так: это семейство окружностей, проходящих через северный полюс \(N\) и попарно друг друга касающихся. Получить представление о них можно из следующего рисунка, где мы выкололи малую окрестность южного полюса и растянули всё остальное на плоскости.&lt;/p&gt;

&lt;p&gt;&lt;span style=&quot;display:block;text-align:center&quot;&gt;
&lt;img src=&quot;/pic/hairy.png&quot; alt=&quot;Причёсывание ежа&quot; title=&quot;Причёсывание ежа&quot; /&gt;
&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Это семейство линий, кстати, не противоречит теореме, так как не порождает касательного поля: возле северного полюса есть точки с касательными, смотрящими куда угодно.&lt;/p&gt;

&lt;p&gt;Пусть \(\theta(x), x \neq N,\) – (ориентированный) угол между \(v(x)\) и направлением координатной линии в \(x\). Раскрасим точки сферы, кроме \(N\), в три цвета A, B, C в соответствии с тем, попадает ли \(\theta\) в диапазон \([0^\circ,120^\circ), [120^\circ,240^\circ), [240^\circ,360^\circ)\), соответственно. На рисунке пунктиром обозначена граница малой окрестности северного полюса. Под словом “малого” мы понимаем, что поле \(v\) на этой границе очень близко к значению в северном полюсе, и поэтому при обходе пунктирной границы на нашем рисунке вектор \(v\) совершает два полных оборота. Теперь триангулируем очень мелко всю сферу без окрестности северного полюса.
Из сказанного следует, что \(|d_{AB} - d_{BA}| = 2\). Поэтому мы найдём разноцветный треугольник (даже два). Измельчая триангуляцию, и пользуясь соображениями компактности, найдём предельную точку разноцветных треугольников. В ней поле не может быть корректно определено, так как угол \(\theta\) должен одновременно лежать в \([0^\circ,120^\circ], [120^\circ,240^\circ], [240^\circ,360^\circ]\).
\(\square\)&lt;/p&gt;

&lt;h2 id=&quot;28&quot;&gt;—2.8—&lt;/h2&gt;

&lt;p&gt;Пожалуй, наиболее известное применение леммы Шпернера – это вывод теоремы Брауэра о неподвижной точке.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Bohl, 1904].&lt;/strong&gt; Любое непрерывное отображение \(f: B^n \to B^n\) \(n\)-мерного единичного шара в себя имеет неподвижную точку, т.е. точку \(x \in B^n\) такую, что \(f(x) = x\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt;
Теорему можно доказывать, заменив шар на любое гомеоморфное ему множество (осуществляя гомеоморфную “замену координат”). Будем доказывать утверждение для вероятностного симплекса
\[
\triangle^n = \{ x = (x_0, x_1, \ldots, x_n) \in \mathbb{R}^{n+1} : x_0 \ge 0, \ldots, x_n \ge 0,  \sum_i x_i = 1\}.
\]
Предположим, \(f(x) \neq x\) для всех \(x \in \triangle^n\). Тогда красим точку \(x\) в цвет \(i\), если \((f(x))_i &amp;lt; x_i\), и \(i\) – наименьший такой индекс, что это неравенство выполнено. Как обычно, мелко триангулируем наш симплекс, и замечаем, что раскраска получилась шпернеровская: грань, задаваемая \(x_i = 0\), не содержит цвета \(i\). Поэтому существует разноцветный треугольник, и как и раньше, мы можем найти предельную точку \(\hat x\) разноцветных треугольников в последовательности измельчающихся триангуляций. Эта точка должна быть неподвижной, так как \((f(\hat x))_i \le \hat x_i\) для всех \(i\). 
\(\square\)&lt;/p&gt;

&lt;h2 id=&quot;29&quot;&gt;—2.9—&lt;/h2&gt;

&lt;p&gt;В качестве одного занятного приложения теоремы Брауэра мы взглянем на один этюд по мотивам известной теоремы Жордана о том, что что несамопересекающаяся кривая на плоскости разбивает её на две связные части. Часто про эту теорему думают как про неприятную, однако её не так уж сложно вывести из теоремы Брауэра &lt;sup id=&quot;fnref:1&quot;&gt; &lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt; &lt;/sup&gt;.
Мы ограничимся одним важным частным случаем.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема.&lt;/strong&gt; Пусть в прямоугольнике на плоскости нарисованы две кривые \(\gamma_1, \gamma_2: [-1,1] \to [a,b]\times [c,d]\), причём \(\gamma_1\) соединяет левую сторону прямоугольника с правой, а \(\gamma_2\) соединяет верхнюю сторону с нижней. Тогда кривые пересекаются.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt;
Пусть кривые заданы координатно как \(\gamma_1(t) = (x_1(t), y_1(t))\), \(\gamma_2(t) = (x_2(t), y_2(t))\). Если предположить, что кривые не пересекаются, то корректно определено отображение
\[
A(s,t) = \frac{(-x_1(s)+x_2(t), y_1(s) -y_2(t) )}{\max (|x(s)-x_2(t)|, |y_1(s) -y_2(t)|)}
\]
квадрата \([-1,1] \times [-1,1]\) в себя. Мы проверим, что у него нет неподвижных точек, и это будет противоречить теореме Брауэра. Из формулы ясно, что образ \(A\) лежит на границе квадрата. Значит, неподвижная точка обязана быть на границе. При этом левая сторона квадрата \(s=-1\) отображается в правую полуплоскость, так как \(-x_1(s)+x_2(t) = -a + x_2(t) \ge 0\). Аналогично, остальные стороны квадрата тоже не могут иметь неподвижную точку. 
\(\square\)&lt;/p&gt;

&lt;ol&gt;
  &lt;li id=&quot;fn:1&quot;&gt;
    &lt;p&gt;
      Доказательство опубликовано Ryuji Maehara.
    &lt;/p&gt;
    &lt;a href=&quot;#fnref:1&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;
  
&lt;/ol&gt;</content><author><name></name></author><category term="lecture" /><summary type="html"></summary></entry><entry><title type="html">Второй взгляд: лебегова размерность</title><link href="https://balit.ski/lecture/2018/05/10/lecture9.html" rel="alternate" type="text/html" title="Второй взгляд: лебегова размерность" /><published>2018-05-10T00:00:00-04:00</published><updated>2018-05-10T00:00:00-04:00</updated><id>https://balit.ski/lecture/2018/05/10/lecture9</id><content type="html" xml:base="https://balit.ski/lecture/2018/05/10/lecture9.html">&lt;script src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js&quot;&gt;&lt;/script&gt;

&lt;script src=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.js&quot;&gt;&lt;/script&gt;

&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.css&quot; /&gt;

&lt;script&gt;
  disqus_shortname = 'balit-ski';
  jQuery(document).ready(function() {
    jQuery(&quot;p&quot;).inlineDisqussions();
  });
&lt;/script&gt;

&lt;h2 id=&quot;24&quot;&gt;—2.4—&lt;/h2&gt;

&lt;p&gt;Как и лемма Холла, лемма Шпернера – лишь одно из утверждений в большой серии “эквивалентных” теорем, которые для нас будут представлять интерес. Самое знаменитое из них – топологическая теорема Брауэра о неподвижной точке, мы доберёмся до неё чуть позже (как и до идеологии &lt;em&gt;степени отображения&lt;/em&gt;, которая является для нас главным маяком). Начнём с несложных комбинаторных утверждений. Первое утверждение я буду называть коннектор-леммой &lt;sup id=&quot;fnref:1&quot;&gt; &lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt; &lt;/sup&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма [Hochberg–McDiarmid–Saks, 1995].&lt;/strong&gt; Пусть вершины триангуляции \(n\)-мерного симплекса покрашены произвольно в цвета \(1, 2, \ldots, n\). Тогда можно выбрать какой-то цвет \(i\) так, что переходя только по рёбрам, соединяющим вершины цвета \(i\), можно от любой грани добраться до любой другой.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt;
Предположим, не существует цвета, соединяющего все грани. Тогда для любой вершины триангуляции мы можем написать в ней метку, равную минимальному номеру грани, до которой нельзя дойти из данной вершины, шагая по вершинам одного цвета. Наши метки шпернеровские: на грани \(i\) нету меток \(i\). Найдём тогда радужный “разнометочный” симплекс. Метки в его вершинах различны, но цвета каких-то двух вершин совпадают (так как цветов всего \(n\)). Эти две вершины соединены ребром, имеют один цвет, но помечены разными метками. Это противоречит нашему алгоритму проставления меток. 
\(\square\)&lt;/p&gt;

&lt;p&gt;Следующее утверждение я буду называть гекс-леммой, по названию игры гекс.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма [Nash, 1948].&lt;/strong&gt; Рассматривается мелко триангулированный \(n\)-мерный куб \(I^n\). Каждому из \(n\) игроков назначены две противоположные гиперграни куба (суммарно покрывающие всю границу куба). Далее происходит следующая игра: игроки по очереди выставляют фишки своего цвета в вершины триангуляции (в каждой вершине может находиться лишь одна фишка). Выигрывает тот, кто первым сможет сможет соединить свои гиперграни цепочкой фишек своего цвета (в цепочке соседние вершины соединены рёбрами триангуляции). Утверждается, что такая игра не может закончиться ничьей.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;span style=&quot;display:block;text-align:center&quot;&gt;
&lt;img src=&quot;http://www.krammer.nl/hex/wp-content/uploads/2014/11/Hex-bord-met-stenen.png&quot; alt=&quot;Гекс-лемма&quot; title=&quot;Гекс-лемма&quot; /&gt;
&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt;
Предположим, все вершины заполнены фишками, но никто до сих пор не победил. Для каждого цвета \(i\) дорисуем одну новую вершину цвета \(i\) и соединим её со всеми вершинами одной из граней игрока \(i\). Несложно видеть, что на полученный граф можно можно смотреть как на триангуляцию симплекса. В этой триангуляции есть одноцветный коннектор цвета \(i\). Этот коннектор (с выброшенной новой вершиной, если в нём такая была) и даёт цепочку, гарантирующую победу игрока \(i\).
\(\square\)&lt;/p&gt;

&lt;p&gt;От гекс-леммы мы перейдём к её непрерывному аналогу, который иногда называют версией леммы Лебега, хотя доказал (в большей общности) её впервые Брауэр.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма [continuous hex].&lt;/strong&gt; 
Если \(n\)-мерный единичный куб \(I^n\) покрыт \(n\) открытыми&lt;sup id=&quot;fnref:2&quot;&gt; &lt;a href=&quot;#fn:2&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt; &lt;/sup&gt; множествами, то какие-то две противоположные грани можно соединить кривой, лежащей внутри одного из множеств. 
&lt;!-- 2. Если \\(n\\)-мерный единичный куб \\(I^n\\) покрыт конечным числом открытых&lt;sup id=&quot;fnref:2&quot;&gt; &lt;a href=&quot;#fn:2&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt; &lt;/sup&gt; множеств диаметра меньше 1, то какая-то точка куба накрыта хотя бы \\((n+1)\\) множествами.  --&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt;
&lt;!-- Можно считать все множества связными (иначе подразобьём их на компоненты связности).
Предположим, никакие \\(n+1\\) множеств не пересекаются все вместе. Выберем максимальное по включению подсемейство множеств, никакие два из которых не пересекаются. Их объединение назовём \\(U_1\\). --&gt;
Триангулируем куб очень мелко (чтобы каждое ребро триангуляции лежало целиком в одном из множеств покрытия), покрасим вершины в цвета, отвечающие накрывающим множествам (если вершина накрыта несколькими множествами, то можно выбрать любое из них), и применим дискретную гекс-лемму.
\(\square\)&lt;/p&gt;

&lt;h2 id=&quot;25&quot;&gt;—2.5—&lt;/h2&gt;

&lt;p&gt;Другой непрерывный аналог леммы Шпернера – следующий результат Кнастера–Куратовского–Мазуркевича.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма [Knaster–Kuratowski–Mazurkiewicz, 1929].&lt;/strong&gt; 
Если \(n\)-мерный симплекс \(\triangle^n\), гиперграни которого назовём \(F_0, \ldots, F_n\), покрыт открытыми (или замкнутыми) множествами \(U_0, \ldots, U_n\), так что \(F_i \cap U_i = \varnothing \forall i\), то \(\bigcap\limits_{i=0}^{n} U_i \neq \varnothing\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt;
Триангулируем симплекс очень мелко и покрасим вершины в цвета, отвечающие накрывающим множествам (если вершина накрыта несколькими множествами, то можно выбрать любое из них). Полученная раскраска – шпернеровская, поэтому найдётся разноцветный симплекс триангуляции. Если триангуляция была очень мелкая, то где-то внутри этого разноцветного симплекса мы хотели бы найти точку, принадлежащую всем множествам покрытия. Посмотрим на два способа оформить это заключение строго.&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Если все множества покрытия были замкнутыми, можно действовать в духе алгоритмов справедливого деления (—2.2—). Применим лемму Шпернера для серии всё более мелких триангуляций, найдём последовательность уменьшающихся разноцветных треугольников, и из соображений компактности найдём их предельную точку. Так как множества покрытия замкнуты, предельная точка им всем принадлежит.&lt;/li&gt;
  &lt;li&gt;Если все множества покрытия были открытыми, мы можем применить стандартный аргумент, который легко найти в интернете по ключевой фразе “число Лебега”. Для любого открытого покрытия найдётся малое число \(\varepsilon &amp;gt; 0\), такое что любой шарик радиуса \(\varepsilon\) лежит целиком в одном из множеств покрытия. Выберем триангуляцию мелкости меньше \(\varepsilon\), тогда любая точка найденного разноцветного симплекса нам подойдёт.
\(\square\)&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;26&quot;&gt;—2.6—&lt;/h2&gt;

&lt;p&gt;Два непрерывных аналога леммы Шпернера, которые мы доказали в —2.4— и —2.5—, могут быть обобщены до так называемой леммы Лебега о покрытиях.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма [Brouwer, 1913].&lt;/strong&gt;&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;Если \(n\)-мерный куб \(I^n\) покрыт конечным числом открытых (или замкнутых) множеств, никакое из которых не связывает две противоположные грани куба, то какая-то точка куба накрыта хотя бы \((n+1)\) множествами.&lt;/li&gt;
    &lt;li&gt;Если \(n\)-мерный симплекс \(\triangle^n\) покрыт конечным числом открытых (или замкнутых) множеств, никакое из которых не связывает все грани симплекса, то какая-то точка симплекса накрыта хотя бы \((n+1)\) множествами.&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt;
Часть 1 следует из части 2 примерно из того же аргумента, из которого коннектор-лемма влечёт гекс-лемму. Детали я оставляю проверить читателю.&lt;/p&gt;

&lt;p&gt;Чтобы доказать часть 2, для каждой компоненты связности каждого множества покрытия покрасим её в цвет \(i\), если эта компонента не задевает гипергрань симплекса с номером \(i\). По условию теоремы, такое \(i\) существует, а если таких \(i\) несколько, выберем любое. Пусть \(U_i\) – объединение всех компонент, покрашенных в цвет \(i\). Множества \(U_i\) удовлетворяют посылке леммы ККМ, из которой мы заключаем результат.
\(\square\)&lt;/p&gt;

&lt;p&gt;Смысл этой теоремы – &lt;em&gt;топологическая инвариантность размерности&lt;/em&gt;. А именно, эта теорема нам говорит, как, обходясь только слабейшими внутренними топологическими свойствами пространства (но не пользуясь ни метрической структурой, ни структурой векторного пространства), можно определить понятие &lt;em&gt;размерности&lt;/em&gt;. Впервые это понятие &lt;em&gt;топологической размерности&lt;/em&gt;, или &lt;em&gt;размерности в смысле покрытий&lt;/em&gt;, или &lt;em&gt;размерности Лебега&lt;/em&gt;, явно определил Чех, а большие шаги на пути в этом и в смежных направлениях были сделаны Пуанкаре, Лебегом, Брауэром, Менгером и Урысоном.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Определение.&lt;/em&gt; Для нормального топологического пространства \(X\) размерностью Лебега называется наименьшее целое число \(n\) такое, что для всякого конечного открытого покрытия пространства \(X\) существует вписанное в него (конечное открытое) покрытие кратности \(n+1\).&lt;/p&gt;

&lt;ol&gt;
  &lt;li id=&quot;fn:1&quot;&gt;
    &lt;p&gt;
      Оно было использовано, чтобы ответить на вопрос Уэста 1993 г. о пропускной способности (в смысле, отличном от того, который мы обсуждали) триангулированного треугольника.
    &lt;/p&gt;
    &lt;a href=&quot;#fnref:1&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:2&quot;&gt;
    &lt;p&gt;
      Доказательство можно адаптировать и для замкнутых множеств.
    &lt;/p&gt;
    &lt;a href=&quot;#fnref:2&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;
  
&lt;/ol&gt;</content><author><name></name></author><category term="lecture" /><summary type="html"></summary></entry><entry><title type="html">Задачи</title><link href="https://balit.ski/problems/2018/05/10/problems.html" rel="alternate" type="text/html" title="Задачи" /><published>2018-05-10T00:00:00-04:00</published><updated>2018-05-10T00:00:00-04:00</updated><id>https://balit.ski/problems/2018/05/10/problems</id><content type="html" xml:base="https://balit.ski/problems/2018/05/10/problems.html">&lt;p&gt;Здесь публикуются задачки к курсу. Листочки будут обновляться по мере продвижения в лекциях. Решения можно присылать мне на &lt;a href=&quot;mailto:aleksei.balitskii@phystech.edu&quot;&gt;почту&lt;/a&gt; (в любом виде). Среди задач много действительно трудных, поэтому оценка будет выставляться очень лояльно.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/files/hall_1.pdf&quot;&gt;Листочек 1, вокруг леммы Холла [upd 07.04].&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/files/sperner_2.pdf&quot;&gt;Листочек 2, вокруг леммы Шпернера [upd 10.05].&lt;/a&gt;&lt;/p&gt;</content><author><name></name></author><category term="problems" /><summary type="html">Здесь публикуются задачки к курсу. Листочки будут обновляться по мере продвижения в лекциях. Решения можно присылать мне на почту (в любом виде). Среди задач много действительно трудных, поэтому оценка будет выставляться очень лояльно.</summary></entry><entry><title type="html">Первый взгляд на лемму Шпернера</title><link href="https://balit.ski/lecture/2018/04/21/lecture8.html" rel="alternate" type="text/html" title="Первый взгляд на лемму Шпернера" /><published>2018-04-21T00:00:00-04:00</published><updated>2018-04-21T00:00:00-04:00</updated><id>https://balit.ski/lecture/2018/04/21/lecture8</id><content type="html" xml:base="https://balit.ski/lecture/2018/04/21/lecture8.html">&lt;script src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js&quot;&gt;&lt;/script&gt;

&lt;script src=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.js&quot;&gt;&lt;/script&gt;

&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.css&quot; /&gt;

&lt;script&gt;
  disqus_shortname = 'balit-ski';
  jQuery(document).ready(function() {
    jQuery(&quot;p&quot;).inlineDisqussions();
  });
&lt;/script&gt;

&lt;h2 id=&quot;21&quot;&gt;—2.1—&lt;/h2&gt;

&lt;p&gt;Второй глобальный сюжет, который я хочу осветить, начинается с другой “олимпиадной” комбинаторной леммы. Главная идея этой части курса: дискретные идеи, с которыми мы познакомимся, несложно превратить в непрерывные, и это приведёт нас к ряду нетрудных топологических теорем. Это будет для нас мотивацией – мы сможем доказать множество любопытных утверждений, таких как теорема о причёсывании ежа, элементарно, избегая топологического аппарата. Тем не менее, понятие &lt;em&gt;степени отображения&lt;/em&gt; у нас получится определить и прочувствовать.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма [Sperner, 1928].&lt;/strong&gt; Пусть на плоскости нарисован треугольник \(\triangle\) с вершинами \(v_0, v_1, v_2\). Пусть дана триангуляция \(\triangle\), т.е. разбиение \(\triangle\) на меньшие треугольники, так что любые два треугольника разбиения пересекаются либо по общему ребру, либо по общей вершине, либо не пересекаются вообще. Пусть также вершины триангуляции покрашены в цвета 0, 1, 2, так что сторона \(v_0 v_1\) не содержит цвета 2, сторона \(v_0 v_2\) не содержит цвета 1, сторона \(v_1 v_2\) не содержит цвета 0. Тогда найдётся &lt;em&gt;разноцветный&lt;/em&gt; (или &lt;em&gt;радужный&lt;/em&gt;) треугольник триангуляции, т.е. треугольник разбиения, все вершины которого покрашены в разные цвета.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство 1.&lt;/em&gt;
Посмотрим на триангуляцию как на план замка, в которой треугольники триангуляции обозначают комнаты, рёбра типов 0-2 и 1-2 обозначают стены, а рёбра типа 0-1 обозначают двери. Нарисуем двойственный граф \(G\), вершинами которого являются комнаты (а также внешность замка), а рёбра которого соответствуют дверям между комнатами.&lt;/p&gt;

&lt;p&gt;&lt;span style=&quot;display:block;text-align:center&quot;&gt;
&lt;img src=&quot;https://www.researchgate.net/profile/Yasuhito_Tanaka/publication/258402856/figure/fig3/AS:392620229578752@1470619365066/Sperners-lemma.png&quot; alt=&quot;Лемма Шпернера&quot; title=&quot;Лемма Шпернера&quot; /&gt;
&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Проследим за степенями вершин в графе \(G\). Внутренние комнаты, не являющиеся разноцветными, имеют степень 0 или 2. Разноцветные комнаты, если они есть, имеют степень 1. Внешняя комната имеет степень, равную числу “переключений” 0-1 и 1-0 про проходе вдоль стороны \(v_0v_1\). Это число нечётное. В любом графе количество вершин нечётной степени чётно (доказательство: подсчёт числа рёбер по степеням вершин). Поэтому кроме внешней комнаты, есть ещё нечётное число внутренних комнат нечётной степени, т.е. разноцветных. Поэтому такая комната существует хотя бы одна.
\(\square\)&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Доказательство 2.&lt;/em&gt;
Пусть наш рисунок нарисован в декартовой плоскости \(xOy\). Запустим следующий динамический процесс: пусть каждая вершина \(u\) триангуляции цвета \(i\) линейно движется из своего стартового положения в конечное положение \(v_i\). Движение будет запараметризовано временем \(t\in[0,1]\), т.е. мы имеем движущуюся вершину \(u(t) = (1-t) u + t v_i\). Мы будем следить за непрерывной деформацией триангуляции. В конечный момент времени \(t=1\) триангуляция станет вырожденной: все вершины триангуляции окажутся в вершинах \(\triangle\). Что происходит с каждым отдельным треугольником \(\triangle_i\) триангуляции? Неразноцветные треугольники вырождаются – схлопываются в отрезок или точку. Разноцветные треугольники растягиваются, чтобы совпасть с \(\triangle\). Что происходит с ориентированной площадью \(S_i(t)\) треугольника \(\triangle_i\)? Это квадратичная функция \(t\) (так как может быть выписана в виде подходящего детерминанта, состоящего из линейных функций \(t\)). Ориентацию площади мы выбираем так, чтобы в начальный момент все площади \(S_i(0)\) были положительны. В процессе движения площадь \(S_i(t)\) может поменять знак, если треугольник проходит через вырожденное положение и меняет ориентацию. Тем не менее, можно считать, что на малом промежутке времени \([0,\varepsilon)\) все площади \(S_i(t)\) положительны. Шпернеровское условие (\(v_iv_j\) не содержит цвета \(k\), где все \(i,j,k\) различны) означает, что на малом промежутке времени \([0,\varepsilon)\) деформированная картинка всё ещё является триангуляцией \(\triangle\). Тем самым, полиномиальная функция 
\[
\sum_{i} S_i(t)
\]
является константой на полуинтервале \([0,\varepsilon)\), а значит она константа на отрезке \([0,1]\). Значит,
\[
\sum_{i} S_i(1) = S_{\triangle}.
\]
Ненулевые слагаемые слева (которые могут быть равны только \(\pm S_{\triangle}\)) отвечают разноцветным треугольникам, и поэтому их количество нечётно.
\(\square\)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма [generalized Sperner].&lt;/strong&gt; Пусть \(d\)-мерный симплекс \(\triangle\) с вершинами \(v_0, v_1, v_2\) триангулирован, и вершины триангуляции покрашены в цвета \(0,1, \ldots, d\), так что грань \(v_0 \ldots \widehat{v_i} \ldots v_d\) не содержит цвета \(i\), \(0 \le i \le d\). Тогда количество &lt;em&gt;разноцветных&lt;/em&gt; симплексов триангуляции нечётно.
&lt;em&gt;Доказательство.&lt;/em&gt;
Можно получить индуктивное доказательство, следуя идее доказательства 1 выше. При этом для подсчёта степени внешней вершины двойственного графа воспользоваться утверждением леммы Шпернера на единичку меньшей размерности. Можно получить прямое доказательство, повторить идею доказательства 2 выше. 
\(\square\)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;22&quot;&gt;—2.2—&lt;/h2&gt;

&lt;p&gt;Одно из неожиданных применений леммы Шпернера – справедливое деление. Знаменитый пример, предложенный Фрэнсисом Су: пусть нам нужно поделить пирог на троих капризных людей \(A,B,C\)&lt;sup id=&quot;fnref:1&quot;&gt; &lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt; &lt;/sup&gt;. Пирог будет замоделирован отрезком \([0,1]\) (если не устраивает такая модель пирога, пусть это будет колбаса). У каждого из людей свои особые предпочтения насчёт разных участков пирога, и мы их не знаем. Всё что мы можем узнать от этих людей, формулируется так.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Для любого деления пирога на три части (задаваемой двумя координатами разреза \(0\le x \le y \le 1\)) мы можем спросить любого человека, какую часть из трёх тот находит наиболее предпочтительной. Вообще говоря, человеку может быть безразлично, какой из двух или из трёх кусков выбрать, будем считать что предпочтения могут быть многозначными.&lt;/li&gt;
  &lt;li&gt;Никто не выберет пустой кусок.&lt;/li&gt;
  &lt;li&gt;Предпочтения замкнуты в следующем смысле: если для разрезаний \(0\le x_i \le y_i \le 1\)), где последовательности \(x_i, y_i\) сходящиеся, некий человек всегда предпочитает кусок \(k\), то и для предельного разрезания \(0\le \lim x_i \le \lim y_i \le 1\)) этот человек не будет возражать против куска \(k\).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Заметим, что пространство всех делений пирога
\[
\triangle = \{(x,y) \in \mathbb{R}^2 : 0\le x \le y \le 1\}
\]
есть треугольник. Его вершины суть \(v_0 = (0,0), v_1 = (0,1), v_2 = (1,1)\). Разделим его на маленькие треугольнички регулярным образом (линиями, параллельными сторонам). Каждая вершина разбиения будет назначена одному из участников, как на картинке:&lt;/p&gt;

&lt;p&gt;&lt;span style=&quot;display:block;text-align:center&quot;&gt;
&lt;img src=&quot;https://ds055uzetaobb.cloudfront.net/image_optimizer/b08713edefb326d42742a4533e8c3fad49841f4d.png&quot; alt=&quot;Справедливое деление&quot; title=&quot;Справедливое деление&quot; /&gt;
&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Вершины помечены таким образом, чтобы у любого треугольника нашей специальной триангуляции вершины были помечены разными людьми.&lt;/p&gt;

&lt;p&gt;Для каждой вершины разбиения \((x,y)\) зададим вопрос соответствующему участнику деления: “какой кусок пирога при этом делении предпочли бы вы?”. Ответ \([0,x]\) кодируем числом (цветом) 2, ответ \([x,y]\) – цветом 1, ответ \([y,1]\) – цветом 0. Если ответ неоднозначен, мы красим вершину в любой из соответствующих цветов. Таким образом мы получаем раскраску вершин триангуляции. Проверим шпернеровское условие. Сторона \(v_0v_1\) (отвечающая \(x=0\)) не содержит цвета 2 – это дано нам условием “никто не выберет пустой кусок”. Аналогично с двумя другими сторонами. Значит выполнено заключение леммы Шпернера, и найдётся разноцветный треугольник. Если полагать, что наша триангуляция была настолько мелкой, что участники не переживают из-за вариации величины пирога такого порядка, то мы победили. Действительно, на вопросы о желанном куске для трёх близких параметров разрезания три человека дали три разных ответа, поэтому любое такое разрезание удовлетворит всех троих. Если же мы хотим точный ответ, что мы можем подразбить \(\triangle\) на ещё более мелкие треугольники (таким же регулярным образом), и повторить процедуру, найдя более мелкий разноцветный треугольник. Повторяем эту процедуру для мелкости разбиения, стремящейся к нулю, и из соображений компактности находим предельную точку найденных разноцветных треугольников. В соответствии с предположением о замкнутости предпочтений предельная точка даст нам оптимальное разрезание пирога.&lt;/p&gt;

&lt;h2 id=&quot;23&quot;&gt;—2.3—&lt;/h2&gt;

&lt;p&gt;Другое применение лемме Шпернера нашлось в вопросе справедливого деления арендной платы. Пусть у нас есть три друга \(A,B,C\), которые собрались снимать жильё суммарной арендной платы 1 у.е. в месяц. В квартире три комнаты, у и трёх участников дележа разные предпочтения насчёт того, насколько эти комнаты хороши. Правила таковы.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Для любого разделения аренды на три части, соответствующие трём комнатам (разделение задаваётся числами \(0\le x \le y \le 1\)), мы можем спросить любого человека, какую комнату из трёх тот находит наиболее предпочтительной при заданной плате. Опять-таки, предпочтения могут быть многозначными.&lt;/li&gt;
  &lt;li&gt;Любой человек согласится на бесплатную комнату.&lt;/li&gt;
  &lt;li&gt;Предпочтения замкнуты в следующем смысле: если для разделений аренды \(0\le x_i \le y_i \le 1\)), где последовательности \(x_i, y_i\) сходящиеся, некий человек всегда предпочитает комнату \(k\), то и для предельного разделения \(0\le \lim x_i \le \lim y_i \le 1\)) этот человек не будет возражать против комнаты \(k\).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Аналогичная предыдущему рассуждению с пирогом процедура приводит к алгоритму, в котором есть один нюанс. Раскраска триангуляции оказывается не шпернеровская, а наоборот: относительная внутренность стороны \(v_0v_1\) (отвечающей \(x=0\)) содержит только цвет 2, и так далее. Нам нужен тогда соответствующий (если угодно, двойственный) вариант леммы Шпернера, утверждающий, что в такой раскраске всё равно найдётся разноцветный треугольник. Эта версия леммы Шпернера действительно верна, и может быть сравнительно просто выведена из обычной леммы Шпернера. Я оставлю детали этого рассуждения читателю, но подскажу, что наш треугольник можно погрузить как серединный внутрь вдвое большего треугольника, и на большем треугольнике доопределить раскраску, чтобы она была шпернеровской.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Замечание.&lt;/em&gt; 
Многомерные аналоги алгоритмов справедливого деления строятся таким же образом. Один из нюансов состоит в том, как выбирать “регулярную” триангуляцию, которую удастся пометить участниками дележа. Ответ может быть такой: имея любую мелкую триангуляцию симплекса, можно рассмотреть её &lt;em&gt;барицентрическое подразбиение&lt;/em&gt;, которое уже несложно пометить правильным образом.&lt;/p&gt;

&lt;ol&gt;
  &lt;li id=&quot;fn:1&quot;&gt;
    &lt;p&gt;
      Алгоритм, который мы обсудим, потребует большого числа вопросов к участникам деления (бесконечного, если нам нужен точный ответ), но зато нам не придётся резать пирог более чем на три куска. В этом его отличие от классического решения задачи о делении для трёх глупцов.
    &lt;/p&gt;
    &lt;a href=&quot;#fnref:1&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

&lt;/ol&gt;</content><author><name></name></author><category term="lecture" /><summary type="html"></summary></entry><entry><title type="html">Минимакс фон Неймана</title><link href="https://balit.ski/lecture/2018/04/14/lecture7.html" rel="alternate" type="text/html" title="Минимакс фон Неймана" /><published>2018-04-14T00:00:00-04:00</published><updated>2018-04-14T00:00:00-04:00</updated><id>https://balit.ski/lecture/2018/04/14/lecture7</id><content type="html" xml:base="https://balit.ski/lecture/2018/04/14/lecture7.html">&lt;script src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js&quot;&gt;&lt;/script&gt;

&lt;script src=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.js&quot;&gt;&lt;/script&gt;

&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.css&quot; /&gt;

&lt;script&gt;
  disqus_shortname = 'balit-ski';
  jQuery(document).ready(function() {
    jQuery(&quot;p&quot;).inlineDisqussions();
  });
&lt;/script&gt;

&lt;h2 id=&quot;120&quot;&gt;—1.20—&lt;/h2&gt;

&lt;p&gt;Теорема, которую мы сейчас докажем, встречается в литературе в разных ипостасях. В теории игр с нулевой суммой используется её частный билинейный случай (следующий из идей линейного программирования). В оптимизации она фигурирует в части характеризации седловых точек функции Лагранжа в задачах выпуклой оптимизации. С другой стороны, вывести её можно из топологических соображений – например, из теоремы Какутани о неподвижной точке&lt;sup id=&quot;fnref:1&quot;&gt; &lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt; &lt;/sup&gt;.&lt;/p&gt;

&lt;p&gt;Следуя статье Б. Френкина в матпросвещении, докажем теорему для класса функций, квазивыпуклых по одному аргументу и квазивогнутых по другому. Будем говорить, что функция 
\(f : U \to \mathbb{R}\), определённая на выпуклом подмножестве \(U \subset \mathbb{R}^n\), &lt;em&gt;квазивыпукла&lt;/em&gt;, если 
\[
f(tx + (1-t)y) \le \max\{f(x), f(y)\} \quad \forall~ x, y \in U, t \in [0,1]. 
\]&lt;/p&gt;

&lt;p&gt;Класс квазивыпуклых функций включает выпуклые функции, монотонные и многие другие. Аналогичным образом, функция \(f : U \to \mathbb{R}\) называется &lt;em&gt;квазивогнутой&lt;/em&gt;, если 
\[
f(tx + (1-t)y) \ge \max\{f(x), f(y)\} \quad \forall~ x, y \in U, t \in [0,1]. 
\]&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [von Neumann, 1928].&lt;/strong&gt; Пусть функция \(h(x,y)\) двух векторных аргументов определена на произведении \(U_x \times U_y\) выпуклых компактов. Пусть \(h\) квазивогнута по \(x\), квазивыпукла по \(y\), и непрерывна по совокупности аргументов. Тогда 
\[
\max_{x} \min_{y} h(x,y) = \min_{y} \max_{x} h(x,y).
\]&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Читатель не должен быть удивлён, что одна половина теоремы совсем простая. А именно, неравенство “максимин не больше минимакса” верно безо всяких предпосылок всегда&lt;sup id=&quot;fnref:2&quot;&gt; &lt;a href=&quot;#fn:2&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt; &lt;/sup&gt;. Доказать нужно лишь то, что максимин не меньше минимакса.&lt;/p&gt;

&lt;p&gt;Пусть \(x = (x_1, x_2, \ldots, x_n), y = (y_1, y_2, \ldots, y_m)\). Можно проверить, что функции
\[
h’(x_2, \ldots, x_n, y_2, \ldots, y_m) = \max_{x_1} \min_{y_1} h(x,y),
\]
\[
h’’ (x_2, \ldots, x_n, y_2, \ldots, y_m) = \min_{y_1} \max_{x_1} h(x,y)
\]
удовлетворяют предпосылкам теоремы: квазивогнутость по первой группе переменных, квазивыпуклость по второй группе переменных, непрерывность по совокупности переменных. Если мы докажем равенство \(h’ = h’’\), то по индукции мы докажем и всю теорему. Для целей доказательства \(h’ = h’’\), мы можем фиксировать значения переменных \(x_2, \ldots, x_n, y_2, \ldots, y_m\) и полагать \(h\) функцией лишь \(x_1\) и \(y_1\) (у которых я буду опускать индекс и писать просто \(x\), \(y\)).&lt;/p&gt;

&lt;p&gt;Для фиксированного \(x\) посмотрим на множество всех \(y\) при которых \(h(x,y)\) достигает минимума по \(y\). Из непрерывности \(h\) следует, что это множество непусто и замкнуто, а из квазивыпуклости – что оно выпукло. Тем самым, оно есть отрезок \([l(x), r(x)]\) (быть может, с совпадающими концами). Аналогично, если мы фиксируем \(y\), то множество значений \(x\) при которых \(h(x,y)\) достигает максимума по \(x\), есть отрезок \([L(y), R(y)]\). Проверим, что функция \(l(x)\) &lt;em&gt;полунепрерывна снизу&lt;/em&gt;. По определению это означает, что из \(x \to x_0\), \(l(x) \to z\) следует \(z \ge l(x_0)\). Итак, пусть \(x \to x_0\), \(l(x) \to z\). Тогда \(h(x, l(x)) \to h(x_0,z)\). С другой стороны, \(h(x, l(x)) = \min\limits_{y} h(x,y)\) – непрерывная функция аргумента \(x\), поэтому \(h(x_0,z) = h(x_0, l(x_0))\), откуда \(z \ge l(x_0)\). Аналогично можно показать, что \(L(y)\) полунепрерывна снизу, а \(r(x), R(y)\) полунепрерывны сверху.&lt;/p&gt;

&lt;p&gt;Для каждого \(x\) рассмотрим объединение 
\[
\bigcup_{y \in [l(x), r(x)]}  [L(y), R(y)].
\]
Из полунепрерывности \(L, R\) мы выведем, что это объединение – один сплошной отрезок. Левая граница объединения достигается из полунепрерывности \(L\), правая – из полунепрерывности \(R\). Предположим, существует число \(x’\), не принадлежащее объединению, но слева и справа от которого есть точки объединения. Точки \(y \in [l(x), r(x)]\) разбиваются на два класса: для которых \([L(y), R(y)]\) лежит слева от \(x’\), и для которых он лежит справа. Найдём такую точку \(y \in [l(x), r(x)]\), в любой окрестности которой встречаются оба класса. Из полунепрерывности \(l\) тогда следует, что \(L(y) \le x’\), из полунепрерывности \(R\) – что \(R(y) \ge x’\), но тогда \(x’ \in [L(y), R(y)]\), противоречие с предположением. Поэтому 
\[
\bigcup_{y \in [l(x), r(x)]}  [L(y), R(y)] = [\lambda(x), \rho(x)].
\]&lt;/p&gt;

&lt;p&gt;Из полунепрерывности \(l,r,L,R\) можно вывести, что \(\lambda(x)\) полунепрерывна снизу, а \(\rho(x)\) – сверху. Рассуждая, как в предыдущем абзаце, найдём \(x_0\) такое, что \(x_0 \in [\lambda(x_0), \rho(x_0)]\). По определению отрезка \([\lambda(x_0), \rho(x_0)]\) это означает, что существует такой \(y_0\), что точка \((x_0,y_0)\) является точкой минимума по \(y\) и точкой максимума по \(x\), т.е. &lt;em&gt;седловой&lt;/em&gt; точкой функции \(h\). Тогда 
\[
\max_{x} \min_{y} h(x,y) \ge h(x_0,y_0) \ge \min_{y} \max_{x} h(x,y),
\]
и теорема доказана.
\(\square\)&lt;/p&gt;

&lt;h2 id=&quot;121&quot;&gt;—1.21*—&lt;/h2&gt;

&lt;p&gt;Френкин замечает в своей статье, что доказательство теоремы Хана–Банаха может быть проведено по той же схеме. Воспроизведу это рассуждение здесь.&lt;/p&gt;

&lt;p&gt;Для начала можно вспомнить теорему об отделимости, которая нам понадобилась в лемме Фаркаша (—1.18—). Смысл её такой: если точка не принадлежит замкнутому выпуклому множеству, то можно их разделить гиперплоскостью. В том наброске, который был предложен в прошлой лекции, использовались существенно два следующих свойства пространства \(\mathbb{R}^n\):&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;евклидова структура (понятие перпендикулярности);&lt;/li&gt;
  &lt;li&gt;конечномерность, которая позволяла провести аргумент с компактностью.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Сейчас мы откажемся от обоих предположений. Для начала нам придётся ознакомиться с парой понятий функционального анализа.&lt;/p&gt;

&lt;p&gt;Мы будем работать в вещественном векторном пространстве \(V\) – это сущность, состоящая из векторов, которые можно складывать, вычитать, и умножать на (вещественные) числа. Важное отличие нашего общего случая от модельного случая \(\mathbb{R}^n\) состоит в том, что теорема наиболее интересна для бесконечномерных векторных пространств (но содержательна для любых). Бесконечномерность означает, что в нашем пространстве не существует конечного базиса, или, эквивалентно, можно найти бесконечную серию из линейно независимых&lt;sup id=&quot;fnref:3&quot;&gt; &lt;a href=&quot;#fn:3&quot; rel=&quot;footnote&quot;&gt;3&lt;/a&gt; &lt;/sup&gt; векторов.&lt;/p&gt;

&lt;p&gt;Отображение \(f: V \to \mathbb{R}\) называется &lt;em&gt;линейным функционалом&lt;/em&gt;, если \(f(\alpha x + \beta y) = \alpha f(x) + \beta f(y)\) для любых \(x,y \in V, \alpha, \beta \in \mathbb{R}\). Отображение \(p: V \to \mathbb{R}\) называется &lt;em&gt;выпуклым функционалом&lt;/em&gt;, если \(p(\alpha x + (1-\alpha) y) \ge \alpha p(x) + (1-\alpha) p(y)\) для любых \(x,y \in V, \alpha \in \mathbb{R}\), а также \(p(\alpha x) = \alpha p(x)\) для любых \(x \in V, \alpha \in \mathbb{R}_{\ge 0}\).&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Hahn, 1927; Banach, 1929].&lt;/strong&gt; Пусть на вещественном линейном пространстве \(V\) задан выпуклый функционал \(p\), а на некотором его подпространстве \(L \subset V\) – линейный функционал \(f\), подчинённый условию 
\[
f(x) \le p(x) \quad \forall x\in L.
\]
Тогда можно продолжить \(f\) до линейного функционала на всём пространстве \(V\) с сохранением неравенства \(f \le p\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Теорема доказывается по индукции. Имея функционал на собственном подпространстве \(L\), мы продолжим его на подпространство “на единицу большей размерности”. Эта фраза хоть и формально бессмысленна (потому что размерности у нас бесконечные), но интуицию она передаёт верно: мы перейдём от \(L\) к \(L’ = L \oplus \langle v \rangle = \{x + \alpha v ~|~ x \in L, \alpha \in \mathbb{R}\}\), где \(v \in V \setminus L\). Для начала разберёмся с этим “индукционным шагом”, а потом я поясню, что я на самом деле понимаю под “индукцией”.&lt;/p&gt;

&lt;p&gt;Функционал \(f\) уже определён на \(L\), и чтобы определить его на \(L’\), нам нужно задать лишь одно число \(f(v)\). Тогда по линейности \(f\) продолжится на \(L’\). Наша задача – выбрать это число \(f(v) = z\) удачно, чтобы неравенство \(f \le p\) выполнялось на \(L’\). Предположим, не существует удачного выбора \(z \in \mathbb{R}\). Тогда для каждого \(z\) отметим непустое множество \(B_z\) всех точек \(x \in L’\), в которых неравенство \(f \le p\) нарушается. В силу выпуклости функционала \(p - f\) множество \(B_z\) выпуклое. При этом оно не пересекается с \(L\). Поэтому оно лежит “по одну сторону” от “гиперплоскости” \(L \subseteq L’\). Формально этот аргумент проводится так: пусть линейный функционал \(\ell : L’ to \mathbb{R}\) определён как \(\ell(x + \alpha v) = \alpha, x \in L, \alpha \in \mathbb{R}\). Если \(B_z\) имеет точки “по обе стороны” от \(L\), то есть точка \(y_+ \in B_z, \ell(y_+) &amp;gt; 0\), и есть точка \(y_- \in B_z, \ell(y_-) &amp;lt; 0\). Поэтому \(y_+ = x_+ + \alpha_+ v, \alpha_+ &amp;gt;0, y_- = x_- + \alpha_- v, \alpha_- &amp;lt;0\). Тогда из выпуклости следует что весь отрезок \([y_+, y_-] = \{t y_+ + (1-t) y_- ~|~ t\in [0,1]\}\) лежит в \(B_z\). Заметим, что 
\[
t y_+ + (1-t) y_- = \underbrace{(t x_+ + (1-t) x_-)}_{\in L} +  (t \alpha_+ + (1-t) \alpha_-) v.
\]
Подбирая \(t\), чтобы \(t \alpha_+ + (1-t) \alpha_- = 0\), мы найдём точку в \(B_z \cap L\), которой существовать не может. Тем самым, все числа \(z \in \mathbb{R}\) разбиваются на два класса, в зависимости от того, с какой стороны от \(L\) лежит \(B_z\). Оба класса непустые (разным классам принадлежат числа \(z &amp;gt; p(v)\) и \(z &amp;lt; -p(-v)\)). Можно проверить, что оба класса – открытые подмножества \(\mathbb{R}\) (нестрогое неравенство \(f \le p\) сохраняется при предельном переходе по \(z\)). Тем самым, вещественная ось оказалась разбита на два непустых открытых подмножества. Это невозможно (на топологическом языке: \(\mathbb{R}\) связно). “Индукционный шаг” доказан.&lt;/p&gt;

&lt;p&gt;Неформально выражаясь, мы бы хотели итерировать процедуру это индукционного шага, чтобы доопределять \(f\) на всё более широких подпространствах, пока наконец не определим его на всём \(V\). Плохая новость состоит в том, что ни за конечное, ни за счётное число шагов мы не исчерпаем всё пространство \(V\), вообще говоря&lt;sup id=&quot;fnref:4&quot;&gt; &lt;a href=&quot;#fn:4&quot; rel=&quot;footnote&quot;&gt;4&lt;/a&gt; &lt;/sup&gt;. Нам нужно сделать ещё больше шагов! В такой пошаговой постановке этот процесс формализовать нельзя. Нам придётся прибегнуть к &lt;em&gt;трансфинитной индукции&lt;/em&gt;, которая по существу эквивалентна аксиоме выбора. 
Заметим, что если мы удачно определили \(f\) на цепочке вложенных пространств (согласованным образом), то мы удачно его определили и на объединении этих подпространств. По модулю аксиомы выбора, этого оказывается достаточно, чтобы доопределить \(f\) на всём \(V\).&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма [Zorn, 1935] &lt;sup id=&quot;fnref:5&quot;&gt; &lt;a href=&quot;#fn:5&quot; rel=&quot;footnote&quot;&gt;5&lt;/a&gt; &lt;/sup&gt;.&lt;/strong&gt; Если в частично упорядоченном множестве любая цепь имеет верхнюю грань, то найдётся максимальный элемент.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Организуем частично упорядоченное множество, элементами которого будут пары (M, g), состоящие из подпространства \(L \subseteq M \subseteq V\) и линейного функционала \(g : M \to \mathbb{R}\), продолжающего \(f\mid_L\), и удовлетворяющего \(g \le p\) на всём \(M\). Будем говорить, что \( (M, g) \prec (M’, g’)\), если \(M \subseteq M’\) и \(g’\mid_M = g\). Если у нас есть цепь (линейно упорядоченное семейство пар \((M_\lambda, g_\lambda)\)), то в качестве верхней грани можно взять пару из \(M = \bigcup\limits_\lambda M_\lambda\), и функционала \(g\), определённого на \(M\) очевидным образом (согласованным со всеми \(g_\lambda\)). Посылки леммы Цорна выполняются, поэтому найдётся некая максимальная пара \((M, g)\). Максимальность означает, что не существует пары, превосходящей \((M, g)\) в терминах нашего порядка. Однако если \(M \neq V\), то конструкция нашего “индукционного шага” позволила бы нам найти такую превосходящую пару. Значит, \(M = V\), и мы нашли функционал \(g\), продолжающий \(f\), как и хотели.
\(\square\)&lt;/p&gt;

&lt;p&gt;Завершу я это обсуждение (и всю первую половину курса) неформальным комментарием о том, почему теорема Хана–Банаха – это по сути та же теорема об отделимости, только очень общая. Представим, что \(L\) одномерно, и мы нарисовали график функционалов \(f\), \(p\) в пространстве \(V \times \mathbb{R}\). График \(p\) есть множество \(\{(x,p(x)) ~ | ~ x \in V\} \subset V \times \mathbb{R}\), а график \(f\) – множество \(\{(x,p(x)) ~ | ~ x\in L \} \subset V \times \mathbb{R}\). Пересечём оба графика “гиперплоскостью” \( H = V \times \{1\} \subset V \times \mathbb{R}\) и посмотрим на картинку, получившуюся в пересечении. Пересечение с графиком \(p\) даст некое выпуклое множество в \(H\), а пересечение с графиком \(f\) – одну точку, не лежащую в этом множестве (здесь мы предполагаем, что функционал \(f\) ненулевой). Тогда продолжение Хана–Банаха даст нам разделяющую гиперплоскость в \(H\). Более того, более-менее любую пару “выпуклое множество и точка снаружи” в пересечении с \(H\) можно получить, подбирая \(p\) и \(f\) соответствующим образом. В этом смысле теорема Хана–Банаха эквивалентна некой достаточно общей теореме отделимости (которую иногда называют теоремой Мазура).&lt;/p&gt;

&lt;!-- 
Нам нужна будет дополнительная структура на \\(V\\), обобщающая евклидову структуру \\(\mathbb{R}^n\\). Мы определим &quot;длину&quot; векторов (но не &quot;углы&quot; между ними) следующим образом.
Функция \\( \\| \cdot \\| : V \to \mathbb{R}\_{\ge 0}\\) называется _нормой_, если выполнены следующие аксиомы:
1. \\(\\|x\\| = 0 \Leftrightarrow x = 0\\).
2. \\(\\| \alpha x\\|\\) = |\alpha| \\| x\\|, \quad \alpha \in \mathbb{R}, x \in V \\) (положительная однородность)
3. \\(\\| x + y \\| \le \\|x\\| + \\|y\\|, \quad x,y \in V \\) (неравенство треугольника).
--&gt;

&lt;ol&gt;
  &lt;li id=&quot;fn:1&quot;&gt;
    &lt;p&gt;
      Я надеюсь, мы это обсудим во второй части курса.
    &lt;/p&gt;
    &lt;a href=&quot;#fnref:1&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:2&quot;&gt;
    &lt;p&gt;
      Как пишет Френкин: &quot;самый длинный среди самых коротких по шеренгам не длиннее, чем самый короткий среди самых длинных по колоннам&quot;. 
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:2&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:3&quot;&gt;
    &lt;p&gt;
      Семейство (возможно, бесконечное) векторов называется линейно независимым, если не существует нетривиальной линейной комбинации конечного поднабора, равной нулю.
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:3&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:4&quot;&gt;
    &lt;p&gt;
      При дополнительных предположениях счётного числа шагов может хватить, и тогда кошмара аксиомы выбора можно избежать. Пример такого предположения: сепарабельность V в какой-то нормированной топологии.
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:4&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;
  
  &lt;li id=&quot;fn:5&quot;&gt;
    &lt;p&gt;
      Кажется, она была известна Куратовскому ещё в 1922-м году.
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:5&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;
  
 
  
&lt;/ol&gt;</content><author><name></name></author><category term="lecture" /><summary type="html"></summary></entry><entry><title type="html">Двойственность линейного программирования</title><link href="https://balit.ski/lecture/2018/04/07/lecture6.html" rel="alternate" type="text/html" title="Двойственность линейного программирования" /><published>2018-04-07T00:00:00-04:00</published><updated>2018-04-07T00:00:00-04:00</updated><id>https://balit.ski/lecture/2018/04/07/lecture6</id><content type="html" xml:base="https://balit.ski/lecture/2018/04/07/lecture6.html">&lt;script src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js&quot;&gt;&lt;/script&gt;

&lt;script src=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.js&quot;&gt;&lt;/script&gt;

&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.css&quot; /&gt;

&lt;script&gt;
  disqus_shortname = 'balit-ski';
  jQuery(document).ready(function() {
    jQuery(&quot;p&quot;).inlineDisqussions();
  });
&lt;/script&gt;

&lt;h2 id=&quot;118&quot;&gt;—1.18—&lt;/h2&gt;
&lt;p&gt;Пришло время познакомиться с элементами выпуклой двойственности. Для нас это будет тот “правильный” геометрический язык, на котором оптимизационные утверждения доказываются просто. Ключевое утверждение, по сути своей детский вариант линейной двойственности, – лемма Фаркаша – наиболее удачно доказывается на языке двойственных конусов. Введём этот язык.&lt;/p&gt;

&lt;p&gt;Непустое множество \(C \subset \mathbb{R}^n\) называется &lt;em&gt;выпуклым конусом&lt;/em&gt;, если \(\lambda x + \mu y \in C\) для любых \(x,y \in C\), \(\lambda, \mu \ge 0\). Конус, &lt;em&gt;порождённый&lt;/em&gt; набором векторов \(X \subset \mathbb{R}^n\), определяется как
\[
\text{cone } X = \{\lambda_1 x_1 + \ldots \lambda_n x_n ~|~ \lambda_i \ge 0, x_i \in X\}.
\]&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Полярным конусом&lt;/em&gt; по отношению к конусу \(C\) называется конус
\[
C^\circ = \{y \in \mathbb{R}^n ~|~ \langle x,y \rangle \le 0 ~ \forall x \in C\}.
\]&lt;/p&gt;

&lt;p&gt;Треугольными скобками я обозначаю обычное скалярное произведение \(\langle x,y \rangle = x^T y = x_1 y_1 + \ldots + x_n y_n\).&lt;/p&gt;

&lt;p&gt;&lt;span style=&quot;display:block;text-align:center&quot;&gt;
&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/a/a8/Polar_cone_illustration.svg/220px-Polar_cone_illustration.svg.png&quot; alt=&quot;Полярный конус&quot; title=&quot;Полярный конус&quot; /&gt;
&lt;/span&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма [Farkas, 1902].&lt;/strong&gt; Пусть даны матрица \(A \in \mathbb{R}^{m \times n}\) и вектор-столбец \(b \in \mathbb{R}^{m}\). Тогда из следующих двух альтернатив &lt;sup id=&quot;fnref:1&quot;&gt; &lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt; &lt;/sup&gt; выполнена ровно одна:&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;либо разрешима система \(Ax=b\), \(x \ge 0\);&lt;/li&gt;
    &lt;li&gt;либо разрешима система \(A^Ty\ge0\), \(b^T y &amp;lt; 0\).&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Рассмотрим выпуклый конус &lt;sup id=&quot;fnref:2&quot;&gt; &lt;a href=&quot;#fn:2&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt; &lt;/sup&gt;
\[
C = \{ Ax ~|~  x \ge 0 \} \subset \mathbb{R}^m.
\]&lt;br /&gt;
Ясно, что это конус, порождённый столбцами матрицы \(A\).
Полярный к нему конус есть не что иное как 
\[
C^\circ = \{y ~|~ A^Ty \ge0\}.
\]
В самом деле,
\[
y \in C^\circ \quad \Leftrightarrow
\]
\[
\langle z,y \rangle \le 0 ~ \forall z \in C \quad \Leftrightarrow
\] 
\[
\langle Ax,y \rangle \le 0 ~ \forall x \ge 0 \quad \Leftrightarrow
\]
\[
\langle x, A^T y \rangle \le 0 ~ \forall x \ge 0 \quad \Leftrightarrow
\]
(подставляя вместо \(x\) базисные вектора \(\mathbb{R}^n\))
\[
A^T y \le 0.
\]&lt;/p&gt;

&lt;p&gt;Первая альтернатива выполнена, если вектор \(b\) лежит в конусе \(C\). Предположим, что она не выполнена. Тогда \(b \notin C\). Мы имеем точку вне замкнутого выпуклого множества – стандартная идея заключается в том, чтобы отделить точку от множества гиперплоскостью. Для этого нам понадобится какой-нибудь вариант теоремы отделимости. В нашем конечномерном случае это утверждение геометрически очевидно. Например, рассмотрим ближайшую к \(b\) точку \(d\) конуса \(С\) (восполните детали: почему такая точка существует?). Тогда гиперплоскость \(H\), проходящая через \(d\) перпендикулярно отрезку \(bd\) и есть разделяющая гиперплоскость в следующем смысле. Пусть \(H\) задана как \(H = \{z \in \mathbb{R}^m ~|~ \langle z, y \rangle = 0\}\)&lt;sup id=&quot;fnref:3&quot;&gt; &lt;a href=&quot;#fn:3&quot; rel=&quot;footnote&quot;&gt;3&lt;/a&gt; &lt;/sup&gt; для какого-то \(y \in \mathbb{R}^m\). Тогда \(\langle b, y \rangle &amp;lt; 0\) и \(\langle z, y \rangle \ge 0 ~\forall z \in C\). Таким образом мы нашли \(y \in C^\circ\), такой что \(b^T y &amp;lt; 0\), что и требовалось.
\(\square\)&lt;/p&gt;

&lt;p&gt;Для расширения нашего кругозора докажем другую версию леммы Фаркаша.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма [Farkas once again].&lt;/strong&gt; Система линейных неравенств \(Ax \le b\), \(x\ge 0\) разрешима относительно \(x\) тогда и только тогда, когда \(b^T y \ge 0\) для любого вектора \(y \ge 0\), удовлетворяющего \(A^Ty \ge 0\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Рассмотрим выпуклый конус
\[
C = \{ Ax ~|~  x \ge 0 \} + \{z \le 0\}.
\] 
Сумма здесь – так называемая &lt;em&gt;сумма Минковского&lt;/em&gt;, которая определена как множество всевозможных сумм \(y + z, y \in \{ Ax ~|~  x \ge 0 \}, z \le 0\).
Полярный к \(C\) конус есть
\[
C^\circ = \{ Ax ~|~  x \ge 0 \}^\circ \cap \{z \le 0\}^\circ.
\]&lt;/p&gt;

&lt;p&gt;Здесь мы воспользовались, что полярная двойственность переводит сумму Минковского в пересечение:
\[
d \in (C_1 + C_2)^\circ \quad \Leftrightarrow
\]
\[
\langle d, c_1 + c_2 \rangle \le 0 ~\forall c_1 \in C_1, c_2 \in C_2 \quad \Leftrightarrow
\]
(подставляя \(c_1 = 0\) и \(c_2=0\) по отдельности)
\[
\langle d, c_1\rangle \le 0 \text{ и }  \langle d,  c_2 \rangle \le 0 ~\forall c_1 \in C_1, c_2 \in C_2 \quad \Leftrightarrow
\]
\[
d \in C_1^\circ \cap  C_2^\circ.
\]
Тогда имеем:
\[
C^\circ = \{y ~|~ A^Ty \ge0\} \cap \{y \ge 0\} = \{y \ge 0 ~|~ A^Ty \ge0\}.
\]
Как и в предыдущей версии, либо \(b \in C\), либо отделяя \(b\) от \(C\) гиперплоскостью с нормалью \(y\), мы найдём \(y \in C^\circ\), удовлетворяющий \(b^Ty &amp;lt;0\), что эквивалентно утверждению леммы.
\(\square\)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма [Farkas one more time].&lt;/strong&gt; Система линейных неравенств \(Ax \le b\) несовместна в том и только том случае, когда положительная линейная комбинация некоторых её неравенств даёт абсурдное неравенство \(0 \le -1\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
В одну сторону утверждение очевидно: если из системы следует неравенство \(0 \le -1\), то решений у неё нет. Для рассуждения в обратную сторону воспользуемся той же идеологией, что и в предыдущих двух случаях. Если система \(Ax \le b\) несовместна, то точка \(b \neq 0\) не лежит в конусе
\[
C = \{ Ax ~|~  x \in \mathbb{R}^n\} + \{z \le 0\}.
\]
Тогда отделяя \(b\) от \(C\) гиперплоскостью с нормалью \(y\), мы найдём \(y \in C^\circ\), удовлетворяющий \(b^Ty &amp;lt;0\).
С другой стороны,
\[
C^\circ = \{y ~|~ A^Ty = 0\} \cap \{y \ge 0\} = \{y \ge 0 ~|~ A^Ty = 0\}.
\]
Найденный \(y \ge 0\) даёт нам неотрицательные коэффициенты для линейной комбинации \(y^T A = 0\) строк матрицы \(A\). Тем самым мы вывели из неравенств системы абсурдное неравенство 
\[
0 = y^T A x \le y^T b &amp;lt; 0.
\]
Чтобы получить неравенство \(0&amp;lt;1\), мы можем поделить коэффициенты \(y\) на \(|y^T b|\).
\(\square\)&lt;/p&gt;

&lt;h2 id=&quot;119&quot;&gt;—1.19—&lt;/h2&gt;

&lt;p&gt;Наконец, мы добрались до задачи линейного программирования. Главный результат для нас, естественно обобщающий многочисленные аналоги леммы Холла, – &lt;em&gt;сильная теорема линейной двойственности&lt;/em&gt;, которую мы легко выведем из леммы Фаркаша. Теорема даёт двойственный взгляд на такую задачу оптимизации: найти максимум линейной функции \(c^T x\) на полиэдре \(\{Ax \le b\}\).&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [von Neumann, 1947; Gale–Kuhn–Tucker, 1951].&lt;/strong&gt; Для любых \(A \in \mathbb{R}^{m \times n}\), \(b \in \mathbb{R}^{m}\), \(c \in \mathbb{R}^{n}\) выполнено равенство
\[
\max \{c^T x ~|~ Ax \le b\} = \min \{b^T y ~|~ y\ge 0, A^T y = c\},
\]
если хотя бы один из оптимумов конечен.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Заметим, что неравенство \(\le\) в теореме очевидно, потому что \(c^Tx = y^T A x \le y^T b\). Это утверждение называют &lt;em&gt;слабой теоремой двойственности&lt;/em&gt; (линейного программирования). Разность правой части и левой тогда неотрицательна и называется &lt;em&gt;зазором двойственности&lt;/em&gt;. Мы покажем, что в задаче линейного программирования этот зазор нулевой (при условии, что одна из частей конечна).&lt;/p&gt;

&lt;p&gt;Рассмотрим три случая.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Если \(\min \{b^T y ~|~ y\ge 0, A^T y = c\} = -\infty\), то из слабой двойственности система \(Ax \le b\) неразрешима, и левая часть тоже равна \(-\infty\).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Если \(\min \{b^T y ~|~ y\ge 0, A^T y = c\} = +\infty\), то по условию левая часть конечна, и в частности существует хотя бы один вектор \(x_0\), такой что \(Ax_0 \le b\). Так как система \(A^T y = c\), \(y\ge 0\) неразрешима, то по лемме Фаркаша существует \(x\), такой что \(Ax \ge 0, c^T x &amp;lt; 0\). Тогда рассматривая вектор \(x_0 - tx\) для сколь угодно большого \(t \in \mathbb{R}\), мы увидим, что что левая часть на самом деле равна \(+\infty\).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Если \(\min \{b^T y ~|~ y\ge 0, A^T y = c\} = m\) конечен, то пусть этот минимум достигается на каком-то векторе \(y_0\). Предположим, что утверждение теоремы неверно, и что система \(c^T x \ge m, Ax \le b\) несовместна. Иными словами, система
\[
\begin{pmatrix} A \\ -c^T \end{pmatrix} x \le \begin{pmatrix} b \\ -m \end{pmatrix}
\]
несовместна. По лемме Фаркаша тогда следующая система совместна:
\[
\begin{cases}
\begin{pmatrix} A \\ -c^T \end{pmatrix}^T \begin{pmatrix} y \\ t \end{pmatrix} = 0 \&lt;br /&gt;
\begin{pmatrix} b \\ -m \end{pmatrix} \begin{pmatrix} y \\ t \end{pmatrix} &amp;lt; 0 \\ 
\begin{pmatrix} y \\ t \end{pmatrix} \ge 0
\end{cases}
\]
Если \(t=0\), мы можем переписать это как
\[
\begin{cases}
A^T y = 0 \&lt;br /&gt;
b^T y &amp;lt; 0 \&lt;br /&gt;
y \ge 0
\end{cases}
\]
Рассматривая тогда \(y_0 + y\), мы получаем противоречие с тем, что \(m\) было минимумом в нашей двойственной задаче линейного программирования. В самом деле, \(y_0 + y \ge 0\), \(A^T(y_0+y) =  A^T y_0 = c\) и \(b^T (y_0+y) &amp;lt; b^T y_0 = m\).
Значит, \(t &amp;gt; 0\), и перемасштабируя вектор \(\begin{pmatrix} y \\ t \end{pmatrix}\), так что \(t=1\), мы получаем: 
\[
\begin{cases}
A^T y = c \&lt;br /&gt;
b^T y &amp;lt; m \&lt;br /&gt;
y \ge 0
\end{cases}
\]
Опять же это противоречит тому, что \(m\) было минимумом.
\(\square\)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Как и у леммы Фаркаша, у этого утверждения много ипостасей. Аналогичным образом можно  доказать следующие утверждения.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема.&lt;/strong&gt; Для любых \(A \in \mathbb{R}^{m \times n}\), \(b \in \mathbb{R}^{m}\), \(c \in \mathbb{R}^{n}\) выполнено каждое из следующих равенств при условии, что хотя бы один из двух из оптимумов конечен.&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;\[
\max \{c^T x ~|~ x \ge 0, Ax \le b\} = \min \{b^T y ~|~ y\ge 0, A^T y \ge c\};
\]&lt;/li&gt;
    &lt;li&gt;\[
\max \{c^T x ~|~ x \ge 0, Ax = b\} = \min \{b^T y ~|~ A^T y \ge c\}.
\]&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;Две задачи на оптимум в левой и правой частях называются &lt;em&gt;прямой&lt;/em&gt; и &lt;em&gt;двойственной&lt;/em&gt; (по отношению друг к другу) задачами линейного программирования. Вы можете заметить паттерн и угадать, как двойственная задача строится по прямой в наиболее общем виде, когда ограничения заданы совокупностью равенств и неравенств разных видов. Например, каждому  неравенству в прямой задаче отвечает неотрицательная переменная в двойственной задаче; матрицы транспонируются; и так далее.&lt;/p&gt;

&lt;p&gt;В качестве полезного упражнения можно проследить, как теорема двойственности влечёт теоремы Эгервари и Форда–Фалкерсона.&lt;/p&gt;

&lt;p&gt;Задачи линейного программирования хороши ещё тем, что для них существуют полиномиальные &lt;sup id=&quot;fnref:4&quot;&gt; &lt;a href=&quot;#fn:4&quot; rel=&quot;footnote&quot;&gt;4&lt;/a&gt; &lt;/sup&gt; алгоритмы &lt;em&gt;внутренней точки&lt;/em&gt;.&lt;/p&gt;

&lt;ol&gt;
  &lt;li id=&quot;fn:1&quot;&gt;
    &lt;p&gt;
      Сравните с альтернативой Фредгольма!
    &lt;/p&gt;
    &lt;a href=&quot;#fnref:1&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:2&quot;&gt;
    &lt;p&gt;
      Всякий раз, когда я пишу неравенство на вектора, подразумевается, что оно выполняется покомпонентно. 
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:2&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:3&quot;&gt;
    &lt;p&gt;
      Наша гиперплоскость проходит через начало координат, потому что &quot;касается&quot; конуса.
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:3&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:4&quot;&gt;
    &lt;p&gt;
      Статус этого утверждения нужно, конечно, уточнить, оговаривая что должно быть рациональным, и как время работы зависит от длины входа с учётом длины записи всех участвующих во входе чисел.
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:4&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;
  
  
&lt;/ol&gt;</content><author><name></name></author><category term="lecture" /><summary type="html"></summary></entry><entry><title type="html">Пятый взгляд: потоки</title><link href="https://balit.ski/lecture/2018/03/28/lecture5.html" rel="alternate" type="text/html" title="Пятый взгляд: потоки" /><published>2018-03-28T00:00:00-04:00</published><updated>2018-03-28T00:00:00-04:00</updated><id>https://balit.ski/lecture/2018/03/28/lecture5</id><content type="html" xml:base="https://balit.ski/lecture/2018/03/28/lecture5.html">&lt;h2 id=&quot;115&quot;&gt;—1.15—&lt;/h2&gt;

&lt;p&gt;Мы уже познакомились с рядом ключевых идей этой части курса. Мы начали с дискретных формулировок леммы Холла и её эквивалентов. Затем при помощи линейной релаксации мы перешли к более непрерывным постановкам задач Эгервари и Биркгофа–Фон Неймана. Тем не менее, эти постановки касались взвешенных паросочетаний в двудольных графах. Сейчас мы откажемся от предположения двудольности и рассмотрим более общую задачу Форда–Фалкерсона, которая решится при помощи круга уже известных нам идей. От задачи Форда–Фалкерсона нам останется лишь один шаг до блестящей идеи двадцатого века – двойственности линейного программирования. Уже сейчас вы можете заметить, как мы постепенно движемся от комбинаторных постановок в сторону геометрических – и формулируем задачи в терминах выпуклых многогранников в многомерных пространствах.&lt;/p&gt;

&lt;p&gt;Итак, рассмотрим постановку &lt;em&gt;транспортной задачи&lt;/em&gt;, или &lt;em&gt;задачи о максимальном потоке в сети&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Пусть \(G = (V,E)\) – ориентированный граф (его рёбра мы иногда будем называть &lt;em&gt;дугами&lt;/em&gt;, просто чтобы отличать их от неориентированных рёбер). Пусть граф также взвешен, то есть каждой дуге \(e = (x,y) = (x \to y)\) приписан вес \(c(e) = c(x,y) \in \mathbb{R}\). Мы будем полагать веса неотрицательными и будем называть их &lt;em&gt;пропускными способностями&lt;/em&gt;. Для нас не будет никакой различия между отсутствием дуги и дугой с нулевой пропускной способностью. В этом связи мы можем полагать, что \(E = V \times V\). Наконец, пусть в графе отмечены две различные вершины \(s, t \in V\) – &lt;em&gt;источник&lt;/em&gt; и &lt;em&gt;сток&lt;/em&gt;, соответственно. Все эти объекты \(N = (V,A,c,s,t)\) в совокупности называются &lt;em&gt;сетью&lt;/em&gt;. Функция \(f : E \to \mathbb{R}\) называется (допустимым) &lt;em&gt;потоком&lt;/em&gt; в сети \(N\), если выполняются следующие условия:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;\(0 \le f(e) \le c(e)\) для каждой дуги \(e \in E\).&lt;/li&gt;
  &lt;li&gt;\(\sum\limits_{u:~u \to v} f(u,v) = \sum\limits_{w:~v \to w} f(v,w)\) для каждой вершины \(v \in V \setminus \{s,t\}\).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Физическая интерпретация: в сети из (односторонних) труб с заданными пропускными способностями (измеряемых в единицах типа литр в секунду) нужно прокачать поток нефти из источника (производителя нефти) к стоку (потребителю). При этом в узлах сети, отличных от источника и стока, нефть не накапливается и не генерируется.&lt;/p&gt;

&lt;p&gt;Задача состоит в том, чтобы найти допустимый поток в сети, максимизирующий следующую величину
\[
F(f) = \sum_{v:~s \to v} f(s,v) - \sum_{u:~u \to s} f(u,s) = \sum_{u:~u \to t} f(u,t) - \sum_{v:~t \to v} f(t,v).
\]
Почему эти две суммы равны? Это очевидно из физической интерпретации: раз нефть нигде не накапливается, то сколько нефти производится в \(s\) в единицу времени (левая часть), столько её и приходит в \(t\) в единицу времени. Формально это равенство можно получить так: просуммировать равенства \(\sum\limits_{u \to v} f(u,v) = \sum\limits_{v \to w} f(v,w)\) по всем \(v \in V \setminus \{s,t\}\) и сократить подобные слагаемые.&lt;/p&gt;

&lt;p&gt;В некотором смысле двойственными по отношению к потокам объектами будут разрезы сети. Назовём &lt;em&gt;разрезом&lt;/em&gt; сети \(N\) разбиение вершин \(V = S \sqcup T\) на два множества, так что \(s \in S, t \in T\). Неформально об этом нужно думать так: представим, что часть труб вышла из строя (мы их разрезали), и теперь из \(s\) невозможно попасть в \(t\) по дугам сети. Все вершины, достижимые из \(s\) по дугам остаточной сети, отнесём в \(S\), а все остальные – в \(T\). Соответствующая двойственная задача состоит в том, чтобы найти разрез \((S, T)\), минимизирующий величину
\[
C(S,T) = \sum_{\substack{x \in S \\ y \in T}} c(x,y).
\]&lt;/p&gt;

&lt;p&gt;Простое следствие всей этой деятельности состоит в том, что \(F(f) \le C(S,T)\) для любых потоков и разрезов. Интуитивно: нельзя прокачать нефти больше, чем тотальная пропускная способность любого разреза сети. Тем самым, чтобы найти максимальный поток в сети, имеет смысл поискать самый “узкий” разрез сети. В свете многих предыдущих формулировок аналогов леммы Холла (типа “такой-то максимум равен такому-то минимуму”) следующая теорема может выглядеть вполне ожидаемой.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Ford–Fulkerson, 1956].&lt;/strong&gt; Величина максимального потока \(F_{\max}\) равна пропускной способности минимального разреза \(C_{\min}\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt;
Мы начнём с того, что докажем строго упомянутое выше неравенство \(F(f) \le C(S,T)\).
Суммируя равенства “непрерывности потока”  \(\sum\limits_{u \to v} f(u,v) = \sum\limits_{v \to w} f(v,w)\) по всем \(v \in S \setminus {s}\), получим
\[
F(f) = \sum_{v:~s \to v} f(s,v) - \sum_{u:~u \to s} f(u,s) = \sum_{\substack{x \in S \\ y \in T}} f(x,y) - \sum_{\substack{y \in T \\ x \in S}} f(y,x) \le \sum_{\substack{x \in S \\ y \in T}} c(x,y) = C(S,T).
\]&lt;/p&gt;

&lt;p&gt;Теперь опишем &lt;em&gt;метод Форда–Фалкерсона&lt;/em&gt;, который может быть преобразован в множество алгоритмов поиска максимального потока (например, Эдмондса–Карпа), зависящих от того, как реализованы детали. Основная идея – поиск увеличивающих путей в остаточной сети. Введём необходимые понятия. Пусть мы уже построили некий поток \(f\), возможно, немаксимальный. Рассмотрим произвольную дугу \(x\to y\) с положительной пропускной способностью. Для начала предположим, что обратной дуги в сети нет, то есть \(c(y,x) = 0\). По дуге \(x\to y\) уже может идти поток \(f(x,y)\). Мы можем думать, что у неё есть &lt;em&gt;остаточная пропускная способность&lt;/em&gt; \(c’(x,y) = c(x,y) - f(x,y)\). Иными словами, если эта труба ещё не насыщена (то есть \(c(x,y) &amp;gt; f(x,y)\)), то мы можем пустить по ней дополнительно ещё \(c’(x,y)\) единиц потока. Что касается остаточной пропускной способности в обратную сторону, её имеет смысл положить равной \(c’(y,x) = f(x,y)\). Это означает, что отправляя дополнительный поток по остаточной дуге \(y \to x\) (которой не было в исходной сети, но она появилась в остаточной), мы как бы “разворачиваем” часть потока \(f(x,y)\) обратно (то есть не отправляем по дуге \(x \to y\), как было запланировано в потоке \(f\)). Но что если изначально существовали обе дуги \(x \to y\) и \(y \to x\)? Общее определение будет таким. Для сети \(N\) с 
допустимым потоком \(f\) определим &lt;em&gt;остаточную сеть&lt;/em&gt; как сеть с тем же базовым графом, но с новыми пропускными способностями
\[
c’(x,y) = c(x,y) - f(x,y) + f(y,x).
\]
Предположим, что нам удалось найти путь из \(s\) в \(t\) по дугам положительной остаточной пропускной способности, пусть минимальная из них равна \(\varepsilon\). Такой путь будем называть &lt;em&gt;увеличивающим&lt;/em&gt;. Тогда вдоль этого пути можно пропустить дополнительный поток величины \(\varepsilon\). Для этого вдоль каждой дуги \(x \to y\) увеличивающего пути мы проделаем следующее: если \(c(x,y) - f(x,y) &amp;gt; 0\), то мы можем немного нарастить \(f(x,y)\); если \(f(y,x) &amp;gt; 0\), мы можем немного уменьшить \(f(y,x)\). Комбинируя эти два действия, мы можем увеличить \(f(x,y) - f(y,x)\) на \(\varepsilon\). Проделаем это вдоль всех рёбер увеличивающего пути, тем самым изменив поток \(f\) и увеличив \(F(f)\) на \(\varepsilon\).&lt;/p&gt;

&lt;p&gt;Метод Форда–Фалкерсона теперь описывается крайне просто:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;начинаем с нулевого потока \(f\);&lt;/li&gt;
  &lt;li&gt;пока в остаточной сети есть увеличивающий путь, увеличиваем поток вдоль этого пути.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Вообще говоря, неочевидно, что такой процесс закончится (если в пропускных способностях есть иррациональности). Для составления алгоритма это нужно было бы разрешить, но для целей нашего доказательства нам это не помешает.&lt;/p&gt;

&lt;p&gt;Итак, рассмотрим произвольный максимальный допустимый поток \(f\). Он существует из соображений компактности. Если в остаточной сети есть увеличивающий путь, то поток не максимален, как объяснено выше. Значит, увеличивающего пути нет. Сформируем разрез: \(S\) – множество всех вершин, достижимых из \(s\) в остаточной сети по дугам положительной остаточной пропускной способности; \(T\) – все остальные вершины, включая \(t\). Этот разрез уже насыщен потоком \(f\) в следующем смысле: для любых \(x \in S, y \in T\) выполнено \(c’(x,y) = 0\) (по определению этого разреза), откуда мы получаем, что \(c(x,y) = f(x,y)\) и \(f(y,x) = 0\). Это означает, что в неравенстве \(F(f) \le C(S,T)\) достиглось равенство:
\[
F(f) = \sum_{v:~s \to v} f(s,v) - \sum_{u:~u \to s} f(u,s) = \sum_{\substack{x \in S \\ y \in T}} f(x,y) - \sum_{\substack{y \in T \\ x \in S}} f(y,x) = \sum_{\substack{x \in S \\ y \in T}} c(x,y) = C(S,T).
\]
Тем самым мы нашли разрез с пропускной способностью, равной величине потока \(f\). Это доказывает теорему.
\(\square\)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Следствие (из доказательства).&lt;/strong&gt; Если все пропускные способности в сети целочисленные, то и максимальный поток целочисленный.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt;
Каждый шаг метода Форда–Фалкерсона увеличивает поток на целую величину, и поэтому метод закончится и возвратит целый максимальный поток.
\(\square\)&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Замечание.&lt;/em&gt;
Неориентированный аналог теоремы Форда–Фалкерсона можно получить, объявив в сети симметричные пропускные способности \(c(x,y) = c(y,x)\).&lt;/p&gt;

&lt;h2 id=&quot;116&quot;&gt;—1.16—&lt;/h2&gt;

&lt;p&gt;Теорема Форда–Фалкерсона – мощное утверждение и влечёт многое из того, что мы уже обсуждали. Я приведу в качестве примера вывод теоремы Менгера, которую тоже относят к условной серии аналогов леммы Холла (её можно доказать из теоремы Холла или Кёнига, но вывод из теории потоков проще). Теорема Менгера о связности графов существует в разных версиях, мы рассмотрим две вариации для неориентированных графов.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Menger, 1927].&lt;/strong&gt; Пусть дан (конечный) неориентированный граф и \(s\), \(t\) – две его вершины. Тогда наибольшее количество рёберно-непересекающихся путей из \(s\) в \(t\) равно наименьшему количеству рёбер, которые надо удалить, чтобы в оставшемся графе не существовало пути из \(s\) в \(t\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Вначале превратим граф в ориентированный, заменяя рёбра на пары дуг. После этого объявим наш граф сетью с единичными пропускными способностями всех дуг, источником \(s\) и стоком \(t\). Тогда максимальный поток насыщает максимальный набор рёберно-непересекающихся путей из \(s\) в \(t\)&lt;sup id=&quot;fnref:1&quot;&gt; &lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt; &lt;/sup&gt;, а минимальный разрез отвечает минимальному набору рёбер, которые надо удалить, чтобы в оставшемся графе не существовало пути из \(s\) в \(t\).
\(\square\)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Menger, 1927].&lt;/strong&gt; Пусть дан (конечный) неориентированный граф и \(s\), \(t\) – две несмежные вершины в нём. Тогда наибольшее количество вершинно-непересекающихся путей из \(s\) в \(t\) равно наименьшему количеству вершин, которые надо удалить (с инцидентными рёбрами), чтобы в оставшемся графе не существовало пути из \(s\) в \(t\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Вначале превратим граф в ориентированный, заменяя рёбра на пары дуг. Чтобы свести задачу к максимальному потоку, воспользуемся идеей раздвоения вершин. А именно, заменим каждую вершину \(v\) на две вершины \(v^+\) и \(v^-\). В \(v^+\) мы направим все дуги, входившие ранее в \(v\). Из \(v^-\) мы направим все дуги, исходившие ранее из \(v\). У всех этих дуг пропускную способность назначим очень большим целым числом. Также проведём дугу пропускной способности 1 из \(v^+\) в \(v^-\). Теорема теперь доказывается применением Форда–Фалкерсона к полученной сети с источником \(s^-\) и стоком \(t^+\) &lt;sup id=&quot;fnref:2&quot;&gt; &lt;a href=&quot;#fn:2&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt; &lt;/sup&gt;.
\(\square\)&lt;/p&gt;

&lt;h2 id=&quot;117&quot;&gt;—1.17*—&lt;/h2&gt;

&lt;p&gt;Другое стандартное приложение метода Форда–Фалкерсона – поиск паросочетаний в двудольном графе. Метод, который можно так получить, далеко не лучший, но он для нас будет ещё одной (финальной) стадией привыкания к языку линейного программирования, перед тем, как мы его введём.&lt;/p&gt;

&lt;p&gt;Пусть дан двудольный граф \(G = (V = L\cup R, E)\). Преобразуем его в сеть следующим образом: все рёбра графа ориентируем от \(L\) к \(R\); добавим новую вершину – источник \(s\), из которого нарисуем дуги во все вершины доли \(L\); добавим ещё одну новую вершину – сток \(t\), в который проведём дуги из всех вершины доли \(R\). Назначим единичные пропускные способности у всех новых дуг, и бесконечные (читай: очень большие целые) пропускные способности у всех дуг оригинального двудольного графа. Чему отвечает максимальный поток в такой сети? Если мы вспомним следствие из теоремы Форда–Фалкерсона в —1.15—, то метод Форда–Фалкерсона построит нам нам некий целочисленный поток, пропускающий через каждую оригинальную дугу поток величины либо 0, либо 1. Последние можно проинтерпретировать как максимальное паросочетание в графе \(G\)! Представим однако, что мы пользовались каким-нибудь другим методом поиска максимального потока, и он нам мог вернуть любой, в том числе дробный, максимальный поток. Ограничения, накладываемые свойствами сети на величины потока на оригинальных дугах, таковы:&lt;/p&gt;

&lt;p&gt;(1)  \(f(x,y) \ge 0 \quad \forall x \in L, y \in R\);&lt;/p&gt;

&lt;p&gt;(2)  \(\sum\limits_{y :~ x \to y} f(x,y) \le 1 \quad \forall x \in L\);  \(\quad \sum\limits_{x :~ x \to y} f(x,y) \le 1 \quad \forall y \in R\).&lt;/p&gt;

&lt;p&gt;Полиэдр \(\mathcal{M}(G) = \{(f(x,y))_{(x \to y) \in E}\text{, удовлетворяющие неравенствам (1)-(2)}\} \subset \mathbb{R}^{|E|}\) называется &lt;em&gt;политопом паросочетаний&lt;/em&gt;. В тот момент, когда мы называем его политопом, неплохо бы описать множество вершин. Ими оказываются целочисленные потоки, соответствующие паросочетаниям в \(G\) &lt;sup id=&quot;fnref:3&quot;&gt; &lt;a href=&quot;#fn:3&quot; rel=&quot;footnote&quot;&gt;3&lt;/a&gt; &lt;/sup&gt;. Доказательство более общего утверждения будет приведено ниже.&lt;/p&gt;

&lt;p&gt;Если в пунктах 2 и 3 мы заменим неравенства на равенства, то получится система ограничений, задающая &lt;em&gt;политоп совершенных паросочетаний&lt;/em&gt;:&lt;/p&gt;

&lt;p&gt;(1) \(f(x,y) \ge 0 \quad \forall x \in L, y \in R\);&lt;/p&gt;

&lt;p&gt;(2’) \(\sum\limits_{y :~ x \to y} f(x,y) = 1 \quad \forall x \in L\); \( \quad \sum\limits_{x :~ x \to y} f(x,y) = 1 \quad \forall y \in R\).&lt;/p&gt;

&lt;p&gt;Иными словами, эти ограничения задают множество всех максимальных потоков (для случая, когда существует совершенное паросочетание). Его вершинами, как нетрудно догадаться, являются целочисленные потоки, отвечающие совершенным паросочетаниям в \(G\). Частным случаем этого утверждения (для полного двудольного графа \(K_{n,n}\)) является теорема Биркгофа–фон Неймана, которую мы уже видели не один раз. Сформулируем это результат аккуратно.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Birkhoff, 1946].&lt;/strong&gt;&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;Политоп паросочетаний двудольного графа, заданный как выпуклая оболочка индикаторных векторов паросочетаний в \(\mathbb{R}^{|E|}\), может быть описан двойственным образом как полиэдр, заданный неравенствами (1), (2).&lt;/li&gt;
    &lt;li&gt;Политоп совершенных паросочетаний двудольного графа, заданный как выпуклая оболочка индикаторных векторов совершенных паросочетаний в \(\mathbb{R}^{|E|}\), может быть описан двойственным образом как полиэдр, заданный ограничениями (1), (2’).&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;Если мы работаем с недвудольным графом \(G\), то условий (1)-(2) уже недостаточно для описания политопа паросочетаний. Обсудим это подробно.&lt;/p&gt;

&lt;p&gt;Пусть \(G = (V,E)\) – граф. Пронумеруем рёбра от 1 до \(|E|\). Для каждого подмножества рёбер \(M \subseteq E\) мы можем рассмотреть вектор \( 1_M \in \mathbb{R}^{|E|}\), компоненты которого равны единицам в позициях, отвечающих элементам из \(M\), и нулям в позициях, отвечающих элементам из \(E \setminus M\). Определим два замечательных многогранника в пространстве \(\mathbb{R}^{|E|}\). &lt;em&gt;Политопом паросочетаний&lt;/em&gt; \(\mathcal{M}(G)\) называется выпуклая оболочка всех векторов \(1_M\) по всем паросочетаниям \(M\) графа \(G\). &lt;em&gt;Политопом совершенных паросочетаний&lt;/em&gt; \(\mathcal{PM}(G)\) называется выпуклая оболочка всех векторов \(1_M\) по всем совершенным паросочетаниям \(M\) графа \(G\). Для вершины \(v \in V\) будем обозначать через \(\delta(v)\) множество рёбер, инцидентных вершине \(v\). Для подмножества вершин \(U \subseteq V\) через \(\delta(U)\) будем обозначать множество рёбер, у которых один конец лежит в \(U\), а второй – в \(V\setminus U\); через \(E(U)\) будем обозначать множество рёбер, у которых оба конца лежат в \(U\). Следующая теорема обобщает теорему Биркгофа, хотя это может быть не очень очевидно (точно так же, как теорема Татта влечёт лемму Холла).&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Edmonds, 1965].&lt;/strong&gt;&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;Политоп паросочетаний \(\mathcal{M}(G)\) может быть описан двойственным образом как полиэдр, заданный следующими неравенствами на вектор \(x \in \mathbb{R}^{|E|}\):&lt;/li&gt;
  &lt;/ol&gt;

  &lt;p&gt;(i) \(x_e \ge 0 \quad \forall e \in E\);&lt;/p&gt;

  &lt;p&gt;(ii) \(\sum\limits_{e \in \delta(v)} x_e \le 1 \quad \forall v \in V\);&lt;/p&gt;

  &lt;p&gt;(iii) \(\sum\limits_{e \in E(U)} x_e \le \lfloor |U|/2 \rfloor \quad \forall U \subseteq V, ~U \text{ нечётной мощности}\).&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;Политоп совершенных паросочетаний \(\mathcal{PM}(G)\) может быть описан двойственным образом как полиэдр, заданный следующими ограничениями на вектор \(x \in \mathbb{R}^{|E|}\):&lt;/li&gt;
  &lt;/ol&gt;

  &lt;p&gt;(i) \(x_e \ge 0 \quad \forall e \in E\);&lt;/p&gt;

  &lt;p&gt;(ii’) \(\sum\limits_{e \in \delta(v)} x_e = 1 \quad \forall v \in V\);&lt;/p&gt;

  &lt;p&gt;(iii’) \(\sum\limits_{e \in \delta(U)} x_e \ge 1 \quad \forall U \subseteq V, ~U \text{ нечётной мощности}\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt;
Вначале докажем часть 2 про совершенные паросочетания.&lt;/p&gt;

&lt;p&gt;Ясно, что любая точка из \(\mathcal{PM}(G)\) удовлетворяет (i), (ii’), (iii’). Чтобы доказать обратное утверждение, предположим, что нашлась вершина \(x\) полиэдра \(Q\), заданного неравенствами (i), (ii’), (iii’), которая не принадлежит \(\mathcal{PM}(G)\). Предоположим также, что этот контрпример минимизирует \(|V|+|E|\). Тогда \(0&amp;lt;x_e&amp;lt;1\) для всех \(e\in E\) (в противном случае, если \(x_e=0\)), то мы можем выбросить ребро \(e\), а если \(x_e=1\), то мы можем выбросить ребро \(e\) вместе с обоими концами). Теперь степень каждой вершины хотя бы 2, и поэтому \(|E| \ge |V|\). Если \(|E| = |V|\), каждая степень равна ровно 2, граф распадается на циклы, и теорема легко проверяется. Значит, \(|E| &amp;gt; |V|\). Из условия (iii’) для \(U = V\) следует, что \(|V|\) чётное.&lt;/p&gt;

&lt;p&gt;Так как \(x\) – вершина \(Q\), то по крайней мере \(|E|\) линейно независимых ограничений из числа (i), (ii’), (iii’) выполняются в виде равенства &lt;sup id=&quot;fnref:4&quot;&gt; &lt;a href=&quot;#fn:4&quot; rel=&quot;footnote&quot;&gt;4&lt;/a&gt; &lt;/sup&gt;. В частности, хотя бы одно ограничение типа (iii’) обращается в равенство (так как \(|E| &amp;gt; |V|\)). Поэтому существует подмножество нечётной мощности \(U \subset V\), \(3 \le |U| \le |V|-3\), такое что \(\sum\limits_{e \in \delta(U)} x_e = 1\).&lt;/p&gt;

&lt;p&gt;Рассмотрим (мульти)графы \(G/U\) и \(G/ (V\setminus U)\), которые получаются из \(G\) отождествлением вершин из \(U\) и \(V\setminus U\) соответственно. Пусть \(x’, x’’\) – проекции вектора \(x\) на соответствующие пространства вида \(\mathbb{R}^{|E|}\), отвечающие этим двум графам. Ограничения типа (i), (ii’), (iii’) выполнены для этих векторов (и для соответствующих графов). Из минимальности \(|V|+|E|\) следует, что \(G/U\) имеет совершенные паросочетания 
\(M_1’, \ldots, M_k’\), так что \(x’\) может быть представлена как выпуклая комбинация векторов \(1_{M_1’}, \ldots, 1_{M_k’}\). Важное замечание: эту комбинацию можно полагать рациональной, потому что \(Q\) задан рациональными неравенствами! Тогда без потери общности можно считать, что 
\[
x’ = \frac{1}{k} \sum_{i=1}^k 1_{M_i’}.
\]
Аналогично, \(G/(V\setminus U)\) имеет совершенные паросочетания 
\(M_1’’, \ldots, M_k’’\), так что 
\[
x’’ = \frac{1}{k} \sum_{i=1}^k 1_{M_i’’}.
\]&lt;/p&gt;

&lt;p&gt;Для любого \(e \in \delta(U)\) количество паросочетаний \(M_i’\), содержащих \(e\), равно \(k x’_e = k x_e = k {x’’}_e\), и равно количеству паросочетаний \(M_i’’\), содержащих \(e\). Поэтому мы можем полагать, что \(M_i’\) и \(M_i’’\) имеют общее ребро в \(\delta(U)\) для любого \(i = 1, \ldots, k\). Поэтому \(M_i := M_i’ \cup M_i’’\) – совершенное паросочетание в \(G\). Тогда
\[
x = \frac{1}{k} \sum_{i=1}^k 1_{M_i},
\]
и \(x\) принадлежит \(\mathcal{PM}(G)\).&lt;/p&gt;

&lt;p&gt;Часть 1 выводится из части 2 следующим образом.&lt;/p&gt;

&lt;p&gt;Опять-таки ясно, что любая точка из \(\mathcal{M}(G)\) удовлетворяет (i), (ii), (iii).
Пусть \(x\) удовлетворяет (i)-(iii). Пусть \(G’ = (V’,E’)\) – копия графа \(G\), и пусть \(\widetilde{G} = (\widetilde{V},\widetilde{E})\) получается объединением \(G\) и \(G’\), в которое мы ещё добавим все рёбра вида \(vv’\), где \(v’ \in V’\) обозначает копию вершины \(v \in V\).&lt;/p&gt;

&lt;p&gt;Вектор \(x \in \mathbb{R}^{|E|}\) определяет вектор \(\widetilde{x}\in \mathbb{R}^{|\widetilde{E}|}\) по правилам 
\[ 
\begin{cases} \widetilde{x}_e = x_e, &amp;amp; e \in E; \\  \widetilde{x}_{e’} = x_e, &amp;amp; e’ \in E’; \\  \widetilde{x}_{vv’} = 1 - \sum\limits_{e \in \delta(v)} x_e, &amp;amp; v \in V. \end{cases} 
\]&lt;/p&gt;

&lt;p&gt;Согласно части 2, \(\widetilde{x} \in \mathcal{PM}(\widetilde{G})\) (условия (i), (ii’), (iii’) нужно проверить, но это нетрудно). Отсюда следует, что \(x \in \mathcal{M}(G)\).
\(\square\)&lt;/p&gt;

&lt;ol&gt;
  &lt;li id=&quot;fn:1&quot;&gt;
    &lt;p&gt;
      Нужно, конечно, это объяснить поподробней. Здесь важно не только утверждение самой теоремы, но и конструкция её следствия: то, как работает метод Форда--Фалкерсона на целочисленной сети.
    &lt;/p&gt;
    &lt;a href=&quot;#fnref:1&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:2&quot;&gt;
    &lt;p&gt;
      Заполните детали этого рассуждения!
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:2&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:3&quot;&gt;
    &lt;p&gt;
      Вообще говоря, политоп паросочетаний определяется через свои вершины, а доказывать нужно как раз факт, что его можно представить системой неравенств. Аккуратно всё это будет сформулировано ниже.
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:3&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:4&quot;&gt;
    &lt;p&gt;
      Это утверждение известно под названием &quot;алгебраический критерий вершины&quot;. Смысл его в том, что в n-мерном пространстве любая вершина любого многогранника прилежит хотя бы к n граням. Интуитивно это весьма очевидно: каждая грань имеет коразмерность 1, и пересечь нужно хотя бы n граней, чтобы получить множество размерности 0 (вершину).
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:4&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;
  
  
&lt;/ol&gt;</content><author><name></name></author><category term="lecture" /><summary type="html">—1.15—</summary></entry><entry><title type="html">Четвёртый взгляд: паросочетания</title><link href="https://balit.ski/lecture/2018/03/17/lecture4.html" rel="alternate" type="text/html" title="Четвёртый взгляд: паросочетания" /><published>2018-03-17T00:00:00-04:00</published><updated>2018-03-17T00:00:00-04:00</updated><id>https://balit.ski/lecture/2018/03/17/lecture4</id><content type="html" xml:base="https://balit.ski/lecture/2018/03/17/lecture4.html">&lt;script src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js&quot;&gt;&lt;/script&gt;

&lt;script src=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.js&quot;&gt;&lt;/script&gt;

&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.css&quot; /&gt;

&lt;script&gt;
  disqus_shortname = 'balit-ski';
  jQuery(document).ready(function() {
    jQuery(&quot;p&quot;).inlineDisqussions();
  });
&lt;/script&gt;

&lt;h2 id=&quot;111&quot;&gt;—1.11—&lt;/h2&gt;

&lt;p&gt;Одно из направлений обобщения холловского результата – получить какие-то его аналоги для произвольных недвудольных графов с целью характеризовать существование совершенного паросочетания или найти максимальное паросочетание. Наш первый недвудольный результат касается простой характеризации максимальных паросочетаний в терминах увеличивающих цепочек. Введём определения. Пусть \(G = (V,E)\) – граф, и пусть \(M \subseteq E\) – паросочетание, т.е. множество рёбер, никакие два из которых не имеют общего конца. Несамопересекающийся путь в графе \(v_0 \to v_1 \to v_2 \to \ldots \to v_{2k-1} \to v_{2k} \to v_{2k+1}\), \(k \ge 0\), называется &lt;em&gt;увеличивающим&lt;/em&gt;, если&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;вершины \(v_1\) и \(v_{2k+1}\) не заняты в паросочетании \(M\) (не являются концами рёбер из \(M\));&lt;/li&gt;
  &lt;li&gt;рёбра \((v_1, v_2), (v_3, v_4), \ldots, (v_{2k-1}, v_{2k})\) входят в \(M\).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Смысл названия в том, что имея увеличивающую цепочку, можно переназначить рёбра паросочетания вдоль \(M\)) так что паросочетание увеличится: для этого надо выбросить рёбра \((v_1, v_2), \ldots, (v_{2k-1}, v_{2k})\) из \(M\)), а вместо них добавить рёбра \((v_0, v_1), (v_2, v_3), \ldots, (v_{2k}, v_{2k+1})\).&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Лемма [Berge, 1957].&lt;/strong&gt; &lt;sup id=&quot;fnref:1&quot;&gt; &lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt; &lt;/sup&gt; Паросочетание  \(M\) в графе \(G = (V, E)\) максимально (по мощности) тогда и только тогда нету увеличивающих цепочек.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt;
Выше мы обсудили, что если увеличивающая цепочка есть, то паросочетание не максимально. В обратную сторону: пусть увеличивающих цепочек нет, но паросочетание \(M\) не максимально, т.е. нашлось паросочетание \(M’\), \(|M’| &amp;gt; |M|\). Рассмотрим симметрическую разность \(S = M’ \triangle M = (M’ \setminus M) \cup (M \setminus M’)\). Рёбра \(S\) образуют подграф \(G\), который разбивается на циклы и цепочки (так как степень каждой вершины в \(S\) не превосходит двух). Из условия \(|M’| &amp;gt; |M|\) следует, что среди компонент \(S\) найдётся увеличивающая цепочка.
\(\square\)&lt;/p&gt;

&lt;p&gt;Лемма Бержа даёт наивный алгоритм поиска максимального паросочетания: ищем увеличивающие пути, пока они есть, и вдоль них оптимизируем паросочетание. К сожалению, поиск увеличивающих цепочек в недвудольном графе (эффективно) организовать непросто из-за наличия нечётных циклов. Наиболее известный (из относительно эффективных и несложных) алгоритм – алгоритм Эдмондса поиска максимального паросочетания – использует дополнительные идеи (поиск &lt;em&gt;цветков&lt;/em&gt;), которые мы обсуждать не будем.&lt;/p&gt;

&lt;p&gt;Чтобы наш второй недвудольный результат выглядел естественным, переформулируем лемму Холла ещё раз.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [yet another Hall formulation].&lt;/strong&gt; Двудольный граф \(G = (V, E)\) имеет совершенное паросочетание в том и только том случае, когда для любого \(U \subseteq V\) подграф графа \(G\), индуцированный на множестве вершин \(V \setminus U\), имеет не более \(|U|\) одновершинных компонент связности (изолированных вершин).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Эта формулировка влечёт исходную: описанное условие запрещает ситуацию, когда отбрасывание множества девочек \(U\) оставит более \(|U|\) мальчиков в состоянии одиночества. Несложно понять их равносильность. Обобщение Татта выглядит теперь совсем удивительным.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Tutte, 1947].&lt;/strong&gt; Граф \(G = (V, E)\) имеет совершенное (т.е. вовлекающее все вершины) паросочетание в том и только том случае, когда для любого \(U \subseteq V\) подграф графа \(G\), индуцированный на множестве вершин \(V \setminus U\), имеет не более \(|U|\) компонент связности с нечётным числом вершин.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Интересно, что применение теоремы Татта для двудольных графов даёт результат сильнее, чем лемма Холла. Будем обозначать через \(o(G - U)\) количество нечётных компонент связности в графе \(G’ = G - U\), полученном из \(G\) удалением вершин \(U\) со всеми инцидентными рёбрами. Критерий Татта тогда говорит, что совершенное паросочетание существует если и только если &lt;em&gt;дефект&lt;/em&gt; любого подмножества \(U\) вершин неположителен:
\[
\text{def}(U) := o(G-U) - |U| \le 0.
\]&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Доказательство Андерсона теоремы Татта.&lt;/em&gt;
Как обычно, в одну сторону утверждение простое.
Пусть в \(G\) есть совершенное паросочетание, и пусть \(U \subseteq V\). Удалим вершины \(U\) с инцидентными рёбрами, получим граф \(G’ = G - U\). Тогда каждая нечётная компонента связности \(G’\) содержит хотя бы одну вершину, из которой ребро совершенного паросочетания идёт в \(U\). Таким образом каждой нечётной компоненте мы ставим в соответствие хотя бы одну вершину \(U\), и разным компонентам сопоставляем разные вершины. Отсюда следует необходимость.&lt;/p&gt;

&lt;p&gt;Достаточность будем доказывать индукцией по \(|V| = 2n\). Здесь мы использовали, что вершин чётное число: это следует из \(\text{def}(\varnothing) = o(G) \le 0\). Пусть все дефекты неположительны. База \(n=1\) тривиальна. Докажем переход. Первое элементарное наблюдение:
\[
o(G-U) \equiv |U| \pmod{2},
\]&lt;br /&gt;
т.е. дефект любого множества чётен.
Возможны два случая (сравните логику с доказательством леммы Холла в —1.1—).&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Дефект любого множества \(U\), \(|U|\ge 2\), строго отрицателен. Тогда \(o(G-U) \le |U| - 2\) (из соображений чётности). Тогда мы возьмём в наше паросочетание одно ребро \((v,u)\) совершенно произвольно, и применим предположение индукции к графу \(G - \{ v,u \} \). Для него него проверяется (проверьте!) таттовское условие неположительности дефектов, поэтому в нём есть максимальное паросочетание. Это паросочетание, объединённое с ребром \((v,u)\), даст максимальное паросочетание в \(G\).&lt;/li&gt;
  &lt;li&gt;Есть множество \(U\), \(|U|\ge 2\), обладающее нулевым дефектом. Выберем самое большое такое множество \(U\). В индуцированном подграфе \(G-U\) ровно \(|U|\) нечётных компонент. Применим лемму Холла, чтобы “поженить” нечётные компоненты \(G-U\) (= “мальчики”) и элементы \(U\) (= “девочки”). Мальчик и девочка знакомы, если элемент-девочка смежен с хотя бы одной из вершин компоненты-мальчика. Предположим противное: какие-то \(k\) мальчиков знакомы с множеством девочек \(T \subset U\), \(|T| &amp;lt; k\). Тогда \(o(G-T) \ge k &amp;gt; |T|\), противоречие с таттовским условием. Тем самым, сватовство удастся, и мы соотнесём все вершины \(U\) с нечётными компонентами \(G-U\). Выберем все рёбра, которые отвечают назначенным парам, и отнесём их в паросочетание, которое мы хотим построить. Теперь нам остаётся достроить это паросочетание до максимального, используя остатки нечётных компонент (из каждой нечётной компоненты мы выбрасываем одну вершину, спаренную с чем-то из \(U\)). Предположим, в одной из нечётных компонент достроить паросочетание не удалось. Пусть это была компонента \(O\), и в ней лежит уже спаренная вершина \(v\). Обозначим \(G’ = O-{v}\). По предположению индукции, существует подмножество вершин \(T\) в \(G’\), не удовлетворяющее условию Татта:
\[
o’(G’-T) &amp;gt; |T|,
\]
где функция \(o’\) считает нечётные компоненты внутри \(G’\). Из соображений чётности \(o’(G’-T) \ge |T|+2\). Но тогда
\[
o(G - (T \cup U \cup {a})) = o’(G’-T) + o(G-U) - 1 \ge |T| + |U| + 1 = |T \cup U \cup {a}|,
\]
что противоречит предположению о максимальности \(U\). 
\(\square\)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Несложно обобщить этот результат до формулы, дающей размер максимального паросочетания в произвольном графе. Пусть множество \(U\) имеет максимальный дефект. Если этот дефект нулевой, то мы показали, что максимальное паросочетание имеет мощность \(\frac12 n\), где \(n = |V|\). Пусть теперь \(\text{def}(U) &amp;gt; 0\). С одной стороны, невозможно будет найти паросочетание размера больше \(\frac12 (n - \text{def}(U))\), и аргумент здесь похож на наше рассуждение в доказательстве необходимости в теореме Татта (по крайней мере \((n - \text{def}(U))\) нечётных компонент \(G-U\) будут насыщены паросочетанием не полностью). С другой стороны, паросочетание размера \(\frac12 (n - \text{def}(U))\) действительно найдётся: для этого добавим к графу \(\text{def}(U)\) новых вершин, каждую из которых мы соединим со всеми вершинами \(V\). После этого можно проверить, что все дефекты станут неположительны, в новом графе будет существовать совершенное паросочетание, из которого мы вычленим паросочетание в \(G\) размера \(\frac12 (n - \text{def}(U))\). То, что мы доказали, обычно называется формулой Татта–Бержа.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Berge, 1958].&lt;/strong&gt; Размер максимального паросочетания в графе \(G = (V, E)\) на \(n\) вершинах определяется по формуле
\[
\frac12 \min_{U \subseteq V}(|U| - o(G-U) + |V|) = \frac12 \min_{U \subseteq V}(n - \text{def}(U)).
\]&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;112&quot;&gt;—1.12—&lt;/h2&gt;

&lt;p&gt;Лемма Холла указывает критерий существования совершенного паросочетания в двудольном графе (а это очень известная задача computer science), но сама она в чистом виде не даёт алгоритма поиска максимального паросочетания. Но такой алгоритм можно получить, покопавшись внимательно в её следствиях. Читатели, знакомые с олимпиадным программированием, вспомнят алгоритм Куна поиска максимального паросочетания в двудольном графе. Он основан на концепции &lt;em&gt;увеличивающей цепочки&lt;/em&gt;, которая обсуждалась выше. Грубо говоря, это просто метод Бержа, упомянутый в —1.11—, где поиск увеличивающих цепочек производится при помощи обхода в глубину. В отсутствие нечётных циклов этот поиск организовать легко.&lt;/p&gt;

&lt;p&gt;Мы пойдём чуть дальше и обсудим &lt;em&gt;венгерский алгоритм&lt;/em&gt; (названный так Куном в честь венгерского вклада Кёнига и Эгервари) для поиска максимального паросочетания во взвешенном двудольном графе. Этот полиномиальный алгоритм более-менее прямо считывается с (алгоритмизованной версии) доказательства теоремы Эгервари, приведённого в —1.9—.&lt;/p&gt;

&lt;p&gt;Постановка &lt;em&gt;задачи о назначениях&lt;/em&gt; такова. Дан полный двудольный граф \(G = (V = L \cup R, E = L \times R)\), \(|L|=|R|=n\), причём каждому ребру \((x,y), x \in L, y \in R\), назначен вес \(w(x,y) \in \mathbb{R}\). Мы хотим найти паросочетание \(M\) максимального суммарного веса. Название задачи интерпретируется так: элементы \(L\) – 
это потенциальные кандидаты на выполнение разных видов работы \(R\), а веса задают полезность, которую принесёт тот или иной кандидат, будучи назначенным на соответствующую работу.&lt;/p&gt;

&lt;p&gt;Вспоминая терминологию из теоремы Эгервари, ввёдем функции дробного вершинного покрытия \(\lambda : L \to \mathbb{R}\), \(\mu : R \to \mathbb{R}\). Функции \(\lambda, \mu\) назовём &lt;em&gt;допустимыми&lt;/em&gt;, если 
\[
\lambda(x) + \mu(y) \ge w(x,y) \quad \forall~ x\in L, y \in R. 
\]
Дефектом покрытия на ребре \((x,y)\), как и раньше, мы назовём величину \(\lambda(x) + \mu(y) - w(x,y)\). Для фиксированного допустимого покрытия \((\lambda, \mu)\) определён подграф на множестве рёбер с нулевым дефектом. Для подмножества \(S \subseteq L\) будем обозначать через \(N(S)\) множество всех вершин из \(R\), смежных с \(S\) по рёбрам нулевого дефекта.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Венгерский алгоритм [Kuhn, 1955].&lt;/strong&gt; &lt;sup id=&quot;fnref:2&quot;&gt; &lt;a href=&quot;#fn:2&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt; &lt;/sup&gt;&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;Стартуем с любого допустимого покрытия \((\lambda, \mu)\), определяем соответствующий бездефектный подграф и находим в нём любое паросочетание \(M\).&lt;/li&gt;
    &lt;li&gt;Если \(|M| = n\), мы победили! (Чтобы это осознать, нужно вспомнить доказательство Эгервари.) Если \(|M| &amp;lt; n\), есть не занятая в паросочетании вершина \(x \in L \). Положим \(S = {x}\) и \(T = \varnothing\).&lt;/li&gt;
    &lt;li&gt;Если \(N(S) \neq T\), переходим на шаг 4. В противном случае \(N(S) = T\). Пусть
\[
\varepsilon = \min_{\substack{x \in S \\ y \in R\setminus T}} (\lambda(x) + \mu(y) - w(x,y)).
\]
Модифицируем дробное покрытие по формулам
\[
\lambda’(x) = \begin{cases}
\lambda(x) - \varepsilon, &amp;amp; x \in S; \&lt;br /&gt;
\lambda(x), &amp;amp; x \in L\setminus S;
\end{cases}
\]
\[
\mu’(y) = \begin{cases}
\mu(y) + \varepsilon, &amp;amp; y \in T; \&lt;br /&gt;
\mu(y), &amp;amp; y \in R\setminus T.
\end{cases}
\]
Эта замена увеличивает бездефектный граф и множество \(N(S)\). Переходим на шаг 4.&lt;/li&gt;
    &lt;li&gt;Выберем \(y \in N(S) \setminus T\). Если \(y\) уже спарена в текущем паросочетании \(M\) с какой-то вершиной \(x \in L\), то заменим \(S\) на \(S\cup{x}\), \(T\) на \(T\cup{y}\), и перейдём на шаг 3. В противном случае можно будет найти увеличивающую цепочку вдоль бездефектных рёбер, заканчивающуюся в \(y\), и использовать её, чтобы увеличить паросочетание \(M\). После этого переходим на шаг 2.&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;Все детали этого алгоритма, связанные с корректностью его работы, уже были неявно включены в доказательство Эгервари, поэтому я их опускаю здесь.&lt;/p&gt;

&lt;h2 id=&quot;113&quot;&gt;—1.13—&lt;/h2&gt;

&lt;p&gt;Другой взгляд на задачу о назначениях приходит из теоремы Биркгофа–фон Неймана. Переведём условие в матричные термины. В матричных терминах \(L\) параметризует строки матрицы весов \(W\), \(R\) параметризует столбцы, а на пересечении строки \(x\) и столбца \(y\) в матрице весов \(W\) написано число \(w(x,y)\). 
Мы ищем биекцию \(\sigma : L \to R\), максимизирующую \(\sum\limits_{x \in L} w(x, \sigma(x))\). В таком виде задача выглядит дискретной оптимизацией, в которой NP-трудные задачи встречаются чаще, чем полиномиально разрешимые. Оказывается, что конкретно эта задача переводится на язык линейного программирования без потери в общности, и этот замечательный факт сокрыт в теореме Биркгофа–фон Неймана. Поясню подробней.&lt;/p&gt;

&lt;p&gt;Рассмотрим линейную релаксацию задачи о назначениях. Это означает, что мы разрешаем дробить кандидатов на доли, и назначать доли кандидатов на должности. Формально, введём матрицу \(A = (a(x,y))_{\substack{x \in L \\ y \in R}}\), у которой каждая строка и каждый столбец суммируется в единицу (\(a(x,y)\) – доля кандидата \(x\), назначенная на работу \(y\)). Поставим теперь задачу максимизации полезности
\[
\sum\limits_{\substack{x \in L \\ y \in R}} a(x,y) w(x,y)
\]
относительно переменных \(a(x,y)\), при условии, что они образуют дважды стохастическую матрицу.&lt;/p&gt;

&lt;p&gt;Релаксированная задача – задача &lt;em&gt;линейного программирования&lt;/em&gt;, т.е. задача о поиске максимума линейной функции на множестве, заданном системой линейных неравенств. Такие задачи эффективно решаются (например, &lt;em&gt;методами внутренней точки&lt;/em&gt;). Причём здесь теорема Биркгофа–фон Неймана? Фактически она говорит, что в нашем случае максимум будет достигнут на перестановочной матрице \(A = P_\sigma\). Тем самым, решая задачу про дробных кандидатов, мы получим целый ответ! В этом свете теорема Биркгофа–фон Неймана может быть переформулирована так:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Birkhoff–von Neumann revisited].&lt;/strong&gt; Перестановочный полиэдр Биркгофа \(\mathcal{P} \subset \mathbb{R}^{n^2}\), заданный системой линейных неравенств как множество всех дважды стохастических матриц, может быть описан двойственным образом как политоп с вершинами в перестановочных матрицах.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Здесь я использовал слова &lt;em&gt;полиэдр&lt;/em&gt; и &lt;em&gt;политоп&lt;/em&gt;, которые можно понимать как “многогранник, заданный системой линейных неравенств” и “многогранник, заданный как выпуклая оболочка своих вершин”. То, что любой выпуклый многогранник (что бы это ни значило) может быть эквивалентно описан и как полиэдр, и как политоп, нуждается в доказательстве &lt;sup id=&quot;fnref:3&quot;&gt; &lt;a href=&quot;#fn:3&quot; rel=&quot;footnote&quot;&gt;3&lt;/a&gt; &lt;/sup&gt; . Идея этого доказательства – замечательная &lt;em&gt;полярная двойственность&lt;/em&gt;, которую я не объясняю здесь только потому, что эта лекция и так уже затянулась.&lt;/p&gt;

&lt;h2 id=&quot;114&quot;&gt;—1.14—&lt;/h2&gt;

&lt;p&gt;Наконец, приведу формулировку одной задачи, которые я впервые встретил на физтеховской студенческой олимпиаде по математике в 2011 году &lt;sup id=&quot;fnref:4&quot;&gt; &lt;a href=&quot;#fn:4&quot; rel=&quot;footnote&quot;&gt;4&lt;/a&gt; &lt;/sup&gt;, а потом оказалось, что эта задача привела к Нобелевской премии по экономике за 2012 год.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Задача [Gale–Shapley, 1962].&lt;/strong&gt;
Пусть есть \(n\) мужчин и \(n\) женщин, причём у каждого мужчины есть линейно упорядоченный список предпочтений касательно женщин (каждый мужчина знает, кто ему нравится больше всего, кто на втором месте, и т.д.), и аналогично у каждой женщины есть список предпочтений касательно мужчин. Пара из мужчины и женщины считается устойчивой, если неверно, что оба в паре предпочитают кого-то другого своему партнёру (один из партнёров может предпочитать кого-то другого, но не оба). Доказать, что независимо от списков предпочтений, существует паросочетание, состоящее из \(n\) устойчивых пар.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Эта задача усложняет постановку задачи организации сватовства по Холлу (мы ищем &lt;em&gt;устойчивое&lt;/em&gt; паросочетание), но леммой Холла не решается. Решение, известное мне, организовано на итерационном процессе, который приводит к устойчивому паросочетанию. Эффективная манифестация существования – алгоритм, приводящий к результату.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Решение.&lt;/em&gt;
Как только начинается сезон отпусков, каждый мужчина отправляет письмо одной даме, возглавляющей его список предпочтений. Каждая дама после получения писем выбирает самого симпатичного ей из числа отправителей, и тут же выходит замуж (если дама не получила писем в этом сезоне, она ничего не делает). Затем все молодожёны уезжают в бессрочный отпуск, и мы их больше не рассматриваем (вычёркиваем из всех списков предпочтений). В последующие годы повторяем такой же сезон отпусков с оставшимися людьми. Ясно, что все люди будут посватаны в конечном итоге. Нужно удостовериться, что образованное паросочетание – устойчивое, проверьте это!
\(\square\)&lt;/p&gt;

&lt;p&gt;Также в своей работе 1962 года Гейл и Шепли рассмотрели ещё несколько похожих по духу задач, например, задачу распределения студентов по колледжам (в свадебной интерпретации это означает, что роль мальчиков выполняют студенты, роль девочек выполняют колледжи, и каждой девочке теперь уже нужно приписать несколько мальчиков). Несколько десятилетий спустя американский экономист Элвин Рот придумал несколько интересных применений на практике алгоритмов поиска устойчивых паросочетаний. Например, он предложил (и даже ввёл в практику в некоторых регионах США, Канады, Великобритании) схему организации очереди на донорские почки. Это позволило существенно увеличить число проводимых трансплантаций и значительно сократить время ожидания трансплантации для больных.&lt;/p&gt;

&lt;p&gt;За эти результаты Шепли и Рот (Гейл к этому времени уже умер) были удостоены Нобелевской премии.&lt;/p&gt;

&lt;ol&gt;
  &lt;li id=&quot;fn:1&quot;&gt;
    &lt;p&gt;
      На самом деле это наблюдение было сделано ещё как минимум в 1891-м году Петерсеном.
    &lt;/p&gt;
    &lt;a href=&quot;#fnref:1&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:2&quot;&gt;
    &lt;p&gt;
      Злые языки поговаривают, что Якоби опубликовал примерно то же самое рассуждение на латыни ещё в 1890-м году.
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:2&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:3&quot;&gt;
    &lt;p&gt;
      Иногда это называют теоремой Вейля--Минковского.
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:3&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:4&quot;&gt;
    &lt;p&gt;
      И не решил тогда.
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:4&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;
  
  
&lt;/ol&gt;</content><author><name></name></author><category term="lecture" /><summary type="html"></summary></entry><entry><title type="html">Третий взгляд: матрицы</title><link href="https://balit.ski/lecture/2018/03/10/lecture3.html" rel="alternate" type="text/html" title="Третий взгляд: матрицы" /><published>2018-03-10T00:00:00-05:00</published><updated>2018-03-10T00:00:00-05:00</updated><id>https://balit.ski/lecture/2018/03/10/lecture3</id><content type="html" xml:base="https://balit.ski/lecture/2018/03/10/lecture3.html">&lt;script src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js&quot;&gt;&lt;/script&gt;

&lt;script src=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.js&quot;&gt;&lt;/script&gt;

&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/tsi-inlineDisqussions-919f4a1/inlineDisqussions.css&quot; /&gt;

&lt;script&gt;
  disqus_shortname = 'balit-ski';
  jQuery(document).ready(function() {
    jQuery(&quot;p&quot;).inlineDisqussions();
  });
&lt;/script&gt;

&lt;h2 id=&quot;18&quot;&gt;—1.8—&lt;/h2&gt;

&lt;p&gt;В прошлой лекции (—1.6—) была доказана теорема Кёнига. Тогда мы её сформулировали в терминах двудольных графов, сейчас давайте её переведём на язык таблиц.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Kőnig revisited]&lt;/strong&gt;. На клеточной доске отмечены некоторые клетки. Минимальное число линий (горизонтальных или вертикальных), которыми можно эти клетки накрыть, равно максимальному числу ладей&lt;sup id=&quot;fnref:1&quot;&gt; &lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt; &lt;/sup&gt;, которых можно в эти клетки поставить без того, чтобы они били друг друга.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;В любом конечном двудольном графе размер максимального паросочетания равен размеру минимального вершинного покрытия.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Перевод такой: строки = вершины левой доли графа; столбцы = вершины правой доли графа; отмеченные клетки = рёбра графа; покрытие доски линиями = вершинное покрытие графа; расстановка ладей = паросочетание в графе.
\(\square\)&lt;/p&gt;

&lt;p&gt;Применим теорему Кёнига, чтобы доказать очередной аналог леммы Холла, на этой раз матричный. Напомню, что &lt;em&gt;перманентом&lt;/em&gt; квадратной матрицы \(A = (a_{ij})_{i,j=1}^n\) называется число, считающееся как определитель по формуле полного разложения, но с плюсами перед всеми слагаемыми:
\[
   \text{per } A = \sum_{(\sigma_1,\ldots,\sigma_n) \in S_n} a_{1 \sigma_1} \cdot \ldots \cdot a_{n \sigma_n},
\]
где суммирование ведётся по перестановкам индексов \(1,\ldots,n\)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Frobenius, 1917]&lt;/strong&gt;. Перманент матрицы \(n\times n\), состоящей из неотрицательных чисел, равен нулю в том и только том случае, когда выполнено следующее условие: для некоторого числа \(k\) найдутся \(k\) строк и \(n-k+1\) столбцов в матрице, такие что любой элемент, лежащий на пересечении этих строк и столбцов, равен нулю.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Разумеется, конкретное значение перманента здесь не по существу. Смысл теоремы только лишь в том, что она устанавливает некий паттерн на расположение нулевых и ненулевых элементов в матрице.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Как и все холловские теоремы, утверждение очевидно в одну сторону. Действительно, если есть нулевая подматрица размера \(k \times (n-k+1)\), то каждое слагаемое в пермутанте есть произведение чисел, (по крайней мере) одно из которых равно нулю (так как обязано “задеть” нулевую подматрицу).&lt;/p&gt;

&lt;p&gt;Докажем обратное. Пусть нулевой \((k \times (n-k+1))\)-подматрицы на нашлось. Чтобы найти положительное слагаемое у пермутанта, нам нужно фактически расставить \(n\) ладей на положительные элементы матрицы. Теорема Кёнига даёт нам критерий того, что \(n\) ладей расставить удастся: это условие равносильно тому, что все положительные элементы матрицы нельзя накрыть менее чем \(n\) линиями. Предположим противное – пусть положительные элементы матрицы можно накрыть \((n-1)\) линиями. Тогда ненакрытая подматрица и есть нулевая \((k \times (n-k+1))\)-подматрица, а таковой быть не должно. 
\(\square\)&lt;/p&gt;

&lt;h2 id=&quot;19&quot;&gt;—1.9—&lt;/h2&gt;

&lt;p&gt;Следующий наш шаг будет в сторону обобщения теоремы Кёнига на случай взвешенных графов. Мы будем его формулировать сразу в матричных терминах.&lt;/p&gt;

&lt;p&gt;Идея следующей теоремы такая. Давайте в шахматной формулировке теоремы Кёнига допустим “дробный” выбор линий. В оригинальной формулировке если некая клетка отмечена, то мы её обязаны накрыть либо горизонталью, либо вертикалью. В новой, &lt;em&gt;линейно релаксированной&lt;/em&gt; формулировке мы разрешим накрыть отмеченную клетку “смесью”, скажем, из 80% горизонтали и 20% вертикали. Тем самым, каждой горизонтали и вертикали мы назначим процентный вес, с которым мы её берём в наш набор линий. &lt;em&gt;Релаксация&lt;/em&gt; заключается в том, что раньше вес каждой линии был строго ноль/единица, а теперь ему разрешено быть любым числом из отрезка \([0,1]\). Пойдём далее и разрешим клеткам таблицы быть отмеченным с разным весом, то есть “отмеченность” клетки измеряется вещественным числом от нуля до единицы. Тогда условие накрытости таково: сумма весов двух линий, накрывающих клетку, должна быть не менее веса самой клетки. Оказывается, что аналог теоремы Кёнига все ещё верен!&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Egerváry, 1931].&lt;/strong&gt; Пусть дана квадратная матрица \(A = (a_{ij})_{i,j=1}^n\), заполненная неотрицательными числами. Рассматриваются всевозможные наборы неотрицательных чисел \(\lambda = (\lambda_1, \ldots, \lambda_n), \mu = (\mu_1, \ldots, \mu_n)\) такие, что \(\lambda_i + \mu_j \ge a_{ij} \ \forall i, j\). Тогда выполнено равенство
   \[
   \min_{\lambda, \mu} \sum_{k=1}^n (\lambda_k + \mu_k) = \max_{\sigma \in S_n} \sum_{i=1}^n a_{i\sigma_i},
   \]
где левый минимум берётся по всевозможным наборам \(\lambda, \mu\), удовлетворяющим вышеуказанным условиям, а правый максимум берётся по всем перестановкам \((\sigma_1,\ldots,\sigma_n)\) индексов \((1,\ldots,n)\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Замечание.&lt;/em&gt; В условии теоремы Эгервари я потребовал неотрицательность весов линий \(\lambda_i, \mu_j\). Это согласуется с нашей интерпретацией “дробных долей” линий, но на самом деле это неважно, мы можем опустить это требование, и ничего не изменится. Действительно, пусть у нас есть какие-то наборы чисел \(\lambda, \mu\), удовлетворяющие “неравенствам накрытия” \(\lambda_i + \mu_j \ge a_{ij} \ \forall i, j\). Предположим, какой-то из весов отрицателен. Выберем отрицательный вес наибольшей абсолютной величины, пусть это, например, \(\lambda_1 &amp;lt; 0\). Тогда из неравенств накрытий следует \(\mu_j \ge |\lambda_1| \ge 0\). Увеличим каждое \(\lambda_i\) на \(|\lambda_1|\), и уменьшим каждое \(\mu_j\) на \(|\lambda_1|\). Неравенства накрытия останутся выполнены, сумма \(\sum_{k=1}^n (\lambda_k + \mu_k)\) не изменится, но зато все веса теперь неотрицательны. Поэтому теорема Эгервари с требованием неотрицательности \(\lambda_i, \mu_j\) эвкивалентна теореме Эгервари без этого требования.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Доказательство теоремы Эгервари.&lt;/em&gt; 
Как всегда, в одну сторону утверждение очевидно. Если неравенства \(\lambda_i + \mu_j \ge a_{ij}\) выполнены, то \(\sum_{k=1}^n (\lambda_k + \mu_k) \ge \sum_{i=1}^n a_{i\sigma_i}\) для любой перестановки \(\sigma\). Нам нужно доказать обратное утверждение.&lt;/p&gt;

&lt;p&gt;Вдумчивый читатель заметит, что доказательство, которое я приведу, по сути мимикрирует приведённое ранее доказательство теоремы Кёнига.&lt;/p&gt;

&lt;p&gt;Как и в тот раз, мы начнём с “минимального покрытия линиями”. Иными словами, рассмотрим такой набор \(\lambda, \mu\), который, во-первых, удовлетворяет всем неравенствам \(\lambda_i + \mu_j \ge a_{ij}\), а во-вторых, минимален из всех наборов, удовлетворяющим этим неравенствам. Минимальность понимается в смысле минимума суммы \(\sum_{k=1}^n (\lambda_k + \mu_k)\). Почему этот минимум достигается? Этот вопрос нужно уяснить отдельно. В типичной математической задаче это бы следовало из компактности множества всех допустимых \((\lambda, \mu) \in \mathbb{R}^{2n}\), и мы бы сказали тогда, что непрерывная функция \(\sum_{k=1}^n (\lambda_k + \mu_k)\) достигает минимума на компакте. Однако компактности у нас нету, допустимое множество неограниченно. Давайте искусственно ограничим его! Мы ищем минимум, поэтому бессмысленно присваивать линиям слишком уж большие веса. Пусть \(M\) – какое-нибудь большое число, например сумма всех элементов матрицы. Имеет ли смысл включать в рассмотрение \(\lambda_i &amp;gt; M\)? Не имеет, потому что можно будет немножко уменьшить \(\lambda_i\), сохранив условия накрытости. Итак, мы минимизируем непрерывную функцию \(\sum_{k=1}^n (\lambda_k + \mu_k)\) на множестве, заданном неравенствами \(0 \le \lambda_i \le M\) (по всем \(i\)), \(0 \le \mu_j \le M\) (по всем \(j\)), \(\lambda_i + \mu_j \ge a_{ij}\) (по всем \(i,j\)). Это подмножество \(\mathbb{R}^{2n}\) замкнуто и ограниченно, следовательно компактно, а значит минимум достигается.&lt;/p&gt;

&lt;p&gt;Следующий шаг из доказательства теоремы Кёнига переводится на язык теоремы Эгервари так: найдём такую перестановку \(\sigma\), что \(\lambda_i + \mu_{\sigma_i} = a_{i \sigma_i}\) для всех \(i\). Это завершит доказательство. Здесь нас спасёт теорема Фробениуса. Назовём неотрицательную разность \(\lambda_i + \mu_j - a_{ij}\) &lt;em&gt;дефектом&lt;/em&gt; выполнения неравенства \(\lambda_i + \mu_j \ge a_{ij}\). Составим отдельную матрицу \(D = (d_{ij})_{i,j=1}^n\), в которой \(d_{ij} = 0\), если соответствующий дефект \(\lambda_i + \mu_j - a_{ij}\) строго положительный, и \(d_{ij} = 1\), если соответствующий дефект нулевой. Я утверждаю, что для матрицы \(D\) выполняются предпосылки теоремы Фробениуса. Действительно, предположим, что в матрице \(D\) есть нулевая \((k \times (n-k+1))\)-подматрица \(O\). Пусть индексы её строк образуют множество \(I\), а индексы её столбцов – множество \(J\), причём \(|I| + |J| = n+1\). Пользуясь этой подматрицей \(O\), мы отрегулируем наборы \(\lambda, \mu\), так что значение \(\sum_{k=1}^n (\lambda_k + \mu_k)\) уменьшится. Это будет противоречием.&lt;/p&gt;

&lt;p&gt;Элементы выбранной подматрицы \(O\) отвечают положительным дефектам в матрице \(A\), пусть \(\varepsilon &amp;gt; 0\) – наименьший из этих дефектов. Увеличим на \(\varepsilon\) все \(\lambda_i, i \notin I\), а затем уменьшим на \(\varepsilon\) все \(\mu_j, j \in J\). Что изменилось? Во-первых, неравенства накрытия по-прежнему верны, потому что уменьшились только лишь дефекты, отвечающие подматрице \(O\), уменьшились они лишь на \(\varepsilon\), но при этом все они были не меньше \(\varepsilon\). Значит, все дефекты остались неотрицательными, и неравенства накрытия выполнены. Во-вторых, сумма \(\sum_{k=1}^n (\lambda_k + \mu_k)\) увеличилась на \(\varepsilon(n-|I|)\), а затем уменьшилась на \(\varepsilon|J|\). Итого она уменьшилась на \(\varepsilon(|J| + |I| - n) = \varepsilon &amp;gt; 0\). В-третьих, какие-то из чисел \(\mu_j\) могли, вообще говоря, стать отрицательными, но тогда мы вспомним замечание выше, и отрегулируем веса так, что они станут неотрицательными. Суммируя сказанное, мы нашли новый допустимый набор весов с суммой \(\sum_{k=1}^n (\lambda_k + \mu_k)\) меньше, чем минимальная. Это противоречие позволяет нам наконец применить теорему Фробениуса, которая влечёт существование перестановки \(\sigma\), такой что дефекты \(\lambda_i + \mu_{\sigma_i} - a_{i \sigma_i}\) нулевые. Это именно то, что мы стремились получить. 
\(\square\)&lt;/p&gt;

&lt;h2 id=&quot;110&quot;&gt;—1.10—&lt;/h2&gt;

&lt;p&gt;На очереди у нас теорема Биркгофа–фон Неймана, ещё один матричный аналог леммы Холла. Воспринимать её можно как релаксацию той простой матричной задачи, которую мы рассмотрели в —1.3—. 
Давайте вспомним её. Дано было то, что в каждой строке \((n\times n)\)-матрицы \(A\) ровно \(r\) единиц, и в каждом столбце ровно \(r\) единиц. Из этого следовало, что можно выбрать в ней \(n\) клеток с единицами, по одной из каждой строки и каждого столбца. Если удалить эти единицы из матрицы, то получится матрица с суммами \(r-1\) по строкам/столбцам, и процесс можно продолжить. Тем самым окажется, что матрица \(A\) представляется в виде суммы \(r\) так называемых &lt;em&gt;перестановочных&lt;/em&gt; матриц, т.е. матриц, содержащих по одной единице в каждой строке и каждом столбце&lt;sup id=&quot;fnref:2&quot;&gt; &lt;a href=&quot;#fn:2&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt; &lt;/sup&gt;. Будем обозначать через (P_\sigma) перестановочную матрицу с единицами в позициях \((i,\sigma_i)\).&lt;/p&gt;

&lt;p&gt;Один шаг остаётся до известнейшей теоремы линейного программирования. Пусть квадратная матрица $n \times n$ из произвольных неотрицательных чисел имеет одну и ту же сумму по всем строкам и всем столбцам. Тогда похожее рассуждение позволит её разложить в сумму перестановочных матриц с некоторыми коэффициентами. Обычно эта теорема формулируется в следующих терминах. Матрица называется &lt;em&gt;дважды стохастической&lt;/em&gt; &lt;sup id=&quot;fnref:3&quot;&gt; &lt;a href=&quot;#fn:3&quot; rel=&quot;footnote&quot;&gt;3&lt;/a&gt; &lt;/sup&gt;, если сумма элементов в любой строке равна 1, и сумма элементов в любом столбце равна 1. &lt;em&gt;Выпуклой комбинацией&lt;/em&gt; матриц &lt;sup id=&quot;fnref:4&quot;&gt; &lt;a href=&quot;#fn:4&quot; rel=&quot;footnote&quot;&gt;4&lt;/a&gt; &lt;/sup&gt; называется линейная комбинация с неотрицательными коэффициентами, сумма которых равна 1.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Birkhoff–von Neumann, 1946].&lt;/strong&gt; Любая дважды стохастическая матрица может быть представлена как выпуклая комбинация перестановочных матриц.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Фактически все идеи уже были озвучены. Доказывать будем чуточку более общее утверждение: если квадратная матрица $n \times n$ из произвольных неотрицательных чисел имеет одну и ту же сумму по всем строкам и всем столбцам, то она раскладывается в сумму перестановочных матриц с неотрицательными коэффициентами. Доказательство проводится индукцией по числу ненулевых элементов в матрице. Если таких элементов меньше \(n\), то матрица уже нулевая, и доказывать нечего. Пусть ненулевые элементы есть. Все позиции ненулевых элементов назовём отмеченными. Мы хотим расставить \(n\) не бьющих друг друга ладей в отмеченные клетки матрицы. Для этого можно воспользоваться чуть ли не любой из нам известных теорем – попробуйте сделать это через лемму Холла напрямую, или же через теорему Кёнига или Фробениуса. Рассуждение через лемму Холла напрямую фактически было уже приведено в —1.3— (идея: подсчитать сумму элементов в подматрице двумя способами), поэтому я не останавливаюсь на этом подробней. После того как ладьи мы поставили в какие-то положительные числа \(a_{1\sigma_1},\ldots,a_{n\sigma_n}\), рассмотрим минимальное из них \(\alpha_\sigma = \min\limits_{i} a_{i\sigma_i}\), и вычтем из нашей матрицы \(A\) матрицу \(\alpha_\sigma P_\sigma\). В полученной матрице \(A-\alpha_\sigma P_\sigma\) сумы по строкам и по столбцам равны, нулей уже больше чем в \(A\), и мы можем применить предположение индукции.
\(\square\)&lt;/p&gt;

&lt;p&gt;В качестве приложения докажем знаменитую теорему Шура.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Теорема [Schur, 1923].&lt;/strong&gt; Пусть дана симметричная матрица \(A = (a_{ij})_{i,j=1}^n\), и пусть \(\lambda_1, \ldots, \lambda_n\) – её собственные числа. Тогда вектор-диагональ \((a_{11}, \ldots, a_{nn})\) может быть представлен в виде выпуклой комбинации векторов–перестановок собственных чисел, т.е. \(\lambda_{\sigma_1}, \ldots, \lambda_{\sigma_n}\), \(\sigma \in S_n\).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;Доказательство.&lt;/em&gt; 
Приведём \(A\) к диагональному виду. Тогда \(A = UDU^T\), где \(D\) – диагональная матрица с диагональными элементами \(\lambda_1, \ldots, \lambda_n\), а \(U = (u_{ij})_{i,j=1}^n\) – ортогональная матрица. Тогда
\[
a_{kk} = \sum_{i=1}^n u_{ki}^2 \lambda_i.
\]
Пусть \(O = (u_{ij}^2)_{i,j=1}^n\). Такого вида матрицы называются &lt;em&gt;ортостохастическими&lt;/em&gt;. В частности, она дважды стохастическая. При этом мы знаем, что \(a = O \lambda\), где мы ввели вектор-столбцы \(a = (a_{11}, \ldots, a_{nn})^T\), \(\lambda = (\lambda_1, \ldots, \lambda_n)^T\). По теореме Биркгофа–фон Неймана, мы можем записать \(O\) в виде выпуклой комбинации \(O = \sum\limits_{\sigma}\alpha_\sigma P_\sigma\). Тогда
\[
a = \sum_{\sigma} \alpha_\sigma P_\sigma \lambda,
\]
что и требовалось.
\(\square\)&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Замечания.&lt;/em&gt;&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Аналогичная теорема верна и для унитарных матриц, доказательство такое же.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Обращение теоремы Шура (любую выпуклую комбинацию перестановок собственных чисел можно реализовать как диагональ симметричной матрицы с этими собственными числами) верно и носит название теоремы Хорна. Есть нетрудное доказательство по индукции, но концептуальное доказательство (чуть более простого унитарного случая) использует симплектическую геометрию (теорему Атии–Гиллемина–Штернберга о выпуклости образа отображения моментов).&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;ol&gt;
  &lt;li id=&quot;fn:1&quot;&gt;
    &lt;p&gt;
      Ладья бьёт всю горизонталь и всю вертикаль, на которой она стоит. Иными словами, когда мы говорим о расстановке ладей, мы имеем в виду, что в любом столбце и в любой строке поставлено не более одной фигуры.
    &lt;/p&gt;
    &lt;a href=&quot;#fnref:1&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:2&quot;&gt;
    &lt;p&gt;
      Название можно объяснить так, если угодно: умножение произвольной матрицы на перестановочную справа эквивалентно перестановке столбцов; умножение произвольной матрицы на перестановочную слева эквивалентно перестановке строк.
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:2&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:3&quot;&gt;
    &lt;p&gt;
      Название мотивируется теорией марковских цепей, где (единожды) стохастической матрицей называется матрица с суммами по строкам, равными 1.
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:3&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;

  &lt;li id=&quot;fn:4&quot;&gt;
    &lt;p&gt;
      Или, более общо, элементов любого векторного пространства.
	&lt;/p&gt;
    &lt;a href=&quot;#fnref:4&quot; rev=&quot;footnote&quot;&gt;↩&lt;/a&gt;
  &lt;/li&gt;
  
  
&lt;/ol&gt;</content><author><name></name></author><category term="lecture" /><summary type="html"></summary></entry></feed>